<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="description" content="This book provides an overview of skills needed for reproducible and open research using the statistical programming language R and tidyverse packages. It covers reproducible workflows, data visualisation, data tidying and wrangling, archiving, iteration and functions, probability and data simulations.">
<title>10&nbsp; Next Steps – Data Skills for Reproducible Research</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./assessment-1.html" rel="next">
<link href="./09-sim.html" rel="prev">
<link href="./images/logos/favicon.ico" rel="icon">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-1fa1d8026083a9bddc52b4aafc7f818e.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-8e00f2f28a1266a720913de837032221.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-c99093b127bbf7463951177fc80c9973.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-77ea140236b98739b7f0b0e161db6ea0.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-6NP3MF25W3"></script><script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-6NP3MF25W3', { 'anonymize_ip': true});
</script><link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="site_libs/datatables-binding-0.33/datatables.js"></script><script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><link href="site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script><link href="site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script><link rel="stylesheet" href="include/psyteachr.css">
<link rel="stylesheet" href="include/webex.css">
<link rel="stylesheet" href="include/style.css">
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./10-next.html"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Next Steps</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Data Skills for Reproducible Research</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/psyteachr/reprores-v5/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-reports.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Reports</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-viz.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Data Visualisation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data Summaries</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-join.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Data Relations</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-tidy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data Tidying</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-wrangle.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Data Wrangling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-func.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Iteration &amp; Functions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-sim.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Probability &amp; Simulation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-next.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Next Steps</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Assessments</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./assessment-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Assessment 1</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./assessment-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Assessment 2</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./assessment-3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Assessment 3</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./assessment-4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Assessment 4</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-license.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Licence/Citation</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-installing-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Installing &amp; Updating R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-symbols.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Symbols</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-conventions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Conventions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-teams.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Using Teams</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-datasets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Datasets</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-debugging.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Debugging</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-import.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">G</span>&nbsp; <span class="chapter-title">Data Import</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-datatypes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">H</span>&nbsp; <span class="chapter-title">Data Types</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-dates.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">I</span>&nbsp; <span class="chapter-title">Dates and Times</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-tables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">J</span>&nbsp; <span class="chapter-title">Table Formatting</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-styling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">K</span>&nbsp; <span class="chapter-title">Styling Plots</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-webpage.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">L</span>&nbsp; <span class="chapter-title">Webpages</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar"><div class="quarto-margin-header"><div class="margin-header-item">
<p><a href="https://doi.org/10.5281/zenodo.6365077"><img src="https://zenodo.org/badge/DOI/10.5281/zenodo.6365077.svg" alt="DOI"></a></p>
</div></div>
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="2"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#sec-ilo-next" id="toc-sec-ilo-next" class="nav-link active" data-scroll-target="#sec-ilo-next">Intended Learning Outcomes</a></li>
  <li>
<a href="#sec-custom-viz" id="toc-sec-custom-viz" class="nav-link" data-scroll-target="#sec-custom-viz"><span class="header-section-number">10.1</span> Visualisation</a>
  <ul class="collapse">
<li><a href="#setup-custom-viz" id="toc-setup-custom-viz" class="nav-link" data-scroll-target="#setup-custom-viz"><span class="header-section-number">10.1.1</span> Set-up</a></li>
  <li><a href="#defaults" id="toc-defaults" class="nav-link" data-scroll-target="#defaults"><span class="header-section-number">10.1.2</span> Defaults</a></li>
  <li><a href="#annotations" id="toc-annotations" class="nav-link" data-scroll-target="#annotations"><span class="header-section-number">10.1.3</span> Annotations</a></li>
  <li><a href="#sec-other-plots" id="toc-sec-other-plots" class="nav-link" data-scroll-target="#sec-other-plots"><span class="header-section-number">10.1.4</span> Other Plots</a></li>
  <li><a href="#resources-custom" id="toc-resources-custom" class="nav-link" data-scroll-target="#resources-custom"><span class="header-section-number">10.1.5</span> Resources</a></li>
  </ul>
</li>
  <li>
<a href="#sec-custom-reports" id="toc-sec-custom-reports" class="nav-link" data-scroll-target="#sec-custom-reports"><span class="header-section-number">10.2</span> Reports</a>
  <ul class="collapse">
<li><a href="#setup-custom-reports" id="toc-setup-custom-reports" class="nav-link" data-scroll-target="#setup-custom-reports"><span class="header-section-number">10.2.1</span> Set-up</a></li>
  <li><a href="#interactive-tables" id="toc-interactive-tables" class="nav-link" data-scroll-target="#interactive-tables"><span class="header-section-number">10.2.2</span> Interactive tables</a></li>
  <li><a href="#other-formats" id="toc-other-formats" class="nav-link" data-scroll-target="#other-formats"><span class="header-section-number">10.2.3</span> Other formats</a></li>
  <li><a href="#sec-resources-report" id="toc-sec-resources-report" class="nav-link" data-scroll-target="#sec-resources-report">Resources</a></li>
  </ul>
</li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/psyteachr/reprores-v5/edit/master/10-next.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/psyteachr/reprores-v5/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li><li><a href="https://github.com/psyteachr/reprores-v5/blob/master/10-next.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span id="sec-next" class="quarto-section-identifier"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Next Steps</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><section id="sec-ilo-next" class="level2 unnumbered ilo"><h2 class="unnumbered ilo anchored" data-anchor-id="sec-ilo-next">Intended Learning Outcomes</h2>
<ul class="task-list">
<li><label><input type="checkbox">Create and customise advanced types of plots</label></li>
<li><label><input type="checkbox">Structure data in report, presentation, and dashboard formats</label></li>
<li><label><input type="checkbox">Be aware of the ways to continue developing computational reproducibility skills</label></li>
</ul></section><section id="sec-custom-viz" class="level2" data-number="10.1"><h2 data-number="10.1" class="anchored" data-anchor-id="sec-custom-viz">
<span class="header-section-number">10.1</span> Visualisation</h2>
<section id="setup-custom-viz" class="level3" data-number="10.1.1"><h3 data-number="10.1.1" class="anchored" data-anchor-id="setup-custom-viz">
<span class="header-section-number">10.1.1</span> Set-up</h3>
<ol type="1">
<li>Open your <code>reprores</code> project</li>
<li>Create a new quarto file called <code>10-viz.qmd</code>
</li>
<li>Update the YAML header</li>
<li>Replace the setup chunk with the one below:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb1-1"><a href="#cb1-1"></a><span class="in">```{r}</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="in">#‎| label: setup</span></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="in">#‎| include: false</span></span>
<span id="cb1-4"><a href="#cb1-4"></a></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="in"># packages needed for this chapter section</span></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="in">library(tidyverse)   # for data wrangling</span></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="in">library(ggthemes)    # for themes</span></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in library(ggthemes): there is no package called 'ggthemes'</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb3-1"><a href="#cb3-1"></a><span class="in">```{r}</span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="in">library(patchwork)   # for combining plots</span></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="in">library(plotly)      # for interactive plots</span></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in library(plotly): there is no package called 'plotly'</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb5-1"><a href="#cb5-1"></a><span class="in">```{r}</span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="in"># devtools::install_github("hrbrmstr/waffle")</span></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="in">library(waffle)      # for waffle plots</span></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in library(waffle): there is no package called 'waffle'</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb7-1"><a href="#cb7-1"></a><span class="in">```{r}</span></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="in">library(ggbump)      # for bump plots</span></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in library(ggbump): there is no package called 'ggbump'</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb9-1"><a href="#cb9-1"></a><span class="in">```{r}</span></span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="in">library(treemap)     # for treemap plots</span></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in library(treemap): there is no package called 'treemap'</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb11-1"><a href="#cb11-1"></a><span class="in">```{r}</span></span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="in">library(ggwordcloud) # for word clouds</span></span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="in">library(tidytext)    # for manipulating text for word clouds</span></span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="in">library(gganimate)   # for animated plots</span></span>
<span id="cb11-5"><a href="#cb11-5"></a></span>
<span id="cb11-6"><a href="#cb11-6"></a><span class="in">#install.packages("rnaturalearthhires", repos = "http://packages.ropensci.org", type = "source")</span></span>
<span id="cb11-7"><a href="#cb11-7"></a><span class="in">library(sf)          # for mapping geoms</span></span>
<span id="cb11-8"><a href="#cb11-8"></a><span class="in">library(rnaturalearth) # for map data</span></span>
<span id="cb11-9"><a href="#cb11-9"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in library(rnaturalearth): there is no package called 'rnaturalearth'</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb13-1"><a href="#cb13-1"></a><span class="in">```{r}</span></span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="in">library(rnaturalearthdata) # extra mapping data</span></span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in library(rnaturalearthdata): there is no package called 'rnaturalearthdata'</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb15-1"><a href="#cb15-1"></a><span class="in">```{r}</span></span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="in">theme_set(theme_light())</span></span>
<span id="cb15-3"><a href="#cb15-3"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Download the <a href="https://raw.githubusercontent.com/rstudio/cheatsheets/main/data-visualization.pdf">ggplot2 cheat sheet</a>.</p>
</section><section id="defaults" class="level3" data-number="10.1.2"><h3 data-number="10.1.2" class="anchored" data-anchor-id="defaults">
<span class="header-section-number">10.1.2</span> Defaults</h3>
<p>The code below creates two plots using the default (light) theme and palettes. First, load the data and set <code>issue_category</code> to a factor so you can control the order of the categories.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="co"># update column specification</span></span>
<span id="cb16-2"><a href="#cb16-2"></a>ct <span class="ot">&lt;-</span> <span class="fu">cols</span>(<span class="at">issue_category =</span> <span class="fu">col_factor</span>(</span>
<span id="cb16-3"><a href="#cb16-3"></a>        <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"tech"</span>, <span class="st">"returns"</span>, <span class="st">"sales"</span>, <span class="st">"other"</span>)</span>
<span id="cb16-4"><a href="#cb16-4"></a>      ))</span>
<span id="cb16-5"><a href="#cb16-5"></a></span>
<span id="cb16-6"><a href="#cb16-6"></a><span class="co"># load data</span></span>
<span id="cb16-7"><a href="#cb16-7"></a>survey_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"data/survey_data.csv"</span>,</span>
<span id="cb16-8"><a href="#cb16-8"></a>                        <span class="at">col_types =</span> ct)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, create a bar plot of number of calls by issue category.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="co"># create bar plot</span></span>
<span id="cb17-2"><a href="#cb17-2"></a>bar <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> survey_data, </span>
<span id="cb17-3"><a href="#cb17-3"></a>              <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> issue_category,</span>
<span id="cb17-4"><a href="#cb17-4"></a>                            <span class="at">fill =</span> issue_category)) <span class="sc">+</span></span>
<span id="cb17-5"><a href="#cb17-5"></a>  <span class="fu">geom_bar</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb17-6"><a href="#cb17-6"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Issue Category"</span>, </span>
<span id="cb17-7"><a href="#cb17-7"></a>       <span class="at">y =</span> <span class="st">"Count"</span>,</span>
<span id="cb17-8"><a href="#cb17-8"></a>       <span class="at">title =</span> <span class="st">"Calls by Issue Category"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And create a scatterplot of wait time by call time, distinguished by issue category.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="co">#create scatterplot</span></span>
<span id="cb18-2"><a href="#cb18-2"></a>point <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> survey_data, </span>
<span id="cb18-3"><a href="#cb18-3"></a>                <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> wait_time, </span>
<span id="cb18-4"><a href="#cb18-4"></a>                              <span class="at">y =</span> call_time,</span>
<span id="cb18-5"><a href="#cb18-5"></a>                              <span class="at">color =</span> issue_category)) <span class="sc">+</span></span>
<span id="cb18-6"><a href="#cb18-6"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb18-7"><a href="#cb18-7"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm, <span class="at">formula =</span> y<span class="sc">~</span>x) <span class="sc">+</span></span>
<span id="cb18-8"><a href="#cb18-8"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Wait Time"</span>,</span>
<span id="cb18-9"><a href="#cb18-9"></a>       <span class="at">y =</span> <span class="st">"Call Time"</span>,</span>
<span id="cb18-10"><a href="#cb18-10"></a>       <span class="at">color =</span> <span class="st">"Issue Category"</span>,</span>
<span id="cb18-11"><a href="#cb18-11"></a>       <span class="at">title =</span> <span class="st">"Wait Time by Call Time"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Finally, combine the two plots using the <code>+</code> from <code class="package">patchwork</code> to see the default styles for these plots.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>bar <span class="sc">+</span> point</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="images/figures/unnamed-chunk-5-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Default plot styles.</figcaption></figure>
</div>
</div>
</div>
<div class="try">
<p>Try changing the theme using built-in themes or customising the colours or linetypes with scale_* functions. See Appendix&nbsp;@ref(plotstyle) for details.</p>
</div>
</section><section id="annotations" class="level3" data-number="10.1.3"><h3 data-number="10.1.3" class="anchored" data-anchor-id="annotations">
<span class="header-section-number">10.1.3</span> Annotations</h3>
<p>It’s often useful to add annotations to a plot, for example, to highlight an important part of the plot or add labels. The <code>annotate()</code> function creates a specific geom at x- and y-coordinates you specify.</p>
<section id="text-annotations" class="level4" data-number="10.1.3.1"><h4 data-number="10.1.3.1" class="anchored" data-anchor-id="text-annotations">
<span class="header-section-number">10.1.3.1</span> Text annotations</h4>
<p>Add a text annotation by setting the <code>geom</code> argument to “text” or “label” and adding a <code>label</code>. Labels have padding and a background, while text is just text.</p>
<ul>
<li>Backslash-n <code>\n</code> in the label text controls where the line breaks are. Try removing or changing the position of these to see what happens.</li>
<li>
<code>x</code> and <code>y</code> control the coordinates of the label. You will likely have to play around with these values to get them right.</li>
<li>The argument <code>hjust</code> is the horizontal justification of text, and <code>vjust</code> is the vertical justification. The default values are 0.5, where the text is centred on the x and y coordinates. 0 will justify to the left and bottom, while 1 justifies to the right and top.</li>
<li>You can change the <code>angle</code> of text, but not labels.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>bar <span class="sc">+</span></span>
<span id="cb20-2"><a href="#cb20-2"></a>  <span class="co"># add left-justified text to the second bar</span></span>
<span id="cb20-3"><a href="#cb20-3"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb20-4"><a href="#cb20-4"></a>           <span class="at">label =</span> <span class="st">"Our goal is to</span><span class="sc">\n</span><span class="st">reduce this</span><span class="sc">\n</span><span class="st">category"</span>,</span>
<span id="cb20-5"><a href="#cb20-5"></a>           <span class="at">x =</span> <span class="fl">1.65</span>, <span class="at">y =</span> <span class="dv">150</span>,</span>
<span id="cb20-6"><a href="#cb20-6"></a>           <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">vjust =</span> <span class="dv">1</span>, </span>
<span id="cb20-7"><a href="#cb20-7"></a>           <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>,</span>
<span id="cb20-8"><a href="#cb20-8"></a>           <span class="at">angle =</span> <span class="dv">45</span>) <span class="sc">+</span></span>
<span id="cb20-9"><a href="#cb20-9"></a>  <span class="co"># add a centred label to the third bar</span></span>
<span id="cb20-10"><a href="#cb20-10"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"label"</span>,</span>
<span id="cb20-11"><a href="#cb20-11"></a>           <span class="at">label =</span> <span class="st">"Our goal is</span><span class="sc">\n</span><span class="st">to increase this</span><span class="sc">\n</span><span class="st">category"</span>,</span>
<span id="cb20-12"><a href="#cb20-12"></a>           <span class="at">x =</span> <span class="dv">3</span>, <span class="at">y =</span> <span class="dv">75</span>,</span>
<span id="cb20-13"><a href="#cb20-13"></a>           <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust =</span> <span class="dv">1</span>, </span>
<span id="cb20-14"><a href="#cb20-14"></a>           <span class="at">color =</span> <span class="st">" darkturquoise"</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="images/figures/annotate-text-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>An example of annotation text and label.</figcaption></figure>
</div>
</div>
</div>
<div class="try">
<p>See if you can work out how to make the figure below, starting with the following:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb21-2"><a href="#cb21-2"></a>       <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">|&gt;</span></span>
<span id="cb21-3"><a href="#cb21-3"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb21-4"><a href="#cb21-4"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Hint: you will need to add 1 label annotation and 8 separate text annotations.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="images/figures/unnamed-chunk-7-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-webex.hide="true">
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb22-2"><a href="#cb22-2"></a>       <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">|&gt;</span></span>
<span id="cb22-3"><a href="#cb22-3"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb22-4"><a href="#cb22-4"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb22-5"><a href="#cb22-5"></a>  <span class="fu">annotate</span>(<span class="st">"label"</span>, <span class="at">label =</span> <span class="st">"In the</span><span class="sc">\n</span><span class="st">middle"</span>,</span>
<span id="cb22-6"><a href="#cb22-6"></a>           <span class="at">x =</span> <span class="fl">0.5</span>, <span class="at">y =</span> <span class="fl">0.5</span>,</span>
<span id="cb22-7"><a href="#cb22-7"></a>           <span class="at">fill =</span> <span class="st">"dodgerblue"</span>, <span class="at">color =</span> <span class="st">"white"</span>,</span>
<span id="cb22-8"><a href="#cb22-8"></a>           <span class="at">label.padding =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">"lines"</span>),</span>
<span id="cb22-9"><a href="#cb22-9"></a>           <span class="at">label.r =</span> <span class="fu">unit</span>(<span class="fl">1.5</span>, <span class="st">"lines"</span>)) <span class="sc">+</span></span>
<span id="cb22-10"><a href="#cb22-10"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">label =</span> <span class="st">"Bottom</span><span class="sc">\n</span><span class="st">Left"</span>,</span>
<span id="cb22-11"><a href="#cb22-11"></a>           <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">vjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb22-12"><a href="#cb22-12"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">label =</span> <span class="st">"Top</span><span class="sc">\n</span><span class="st">Left"</span>, </span>
<span id="cb22-13"><a href="#cb22-13"></a>           <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">1</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">vjust =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb22-14"><a href="#cb22-14"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">label =</span> <span class="st">"Bottom</span><span class="sc">\n</span><span class="st">Right"</span>,</span>
<span id="cb22-15"><a href="#cb22-15"></a>           <span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb22-16"><a href="#cb22-16"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">label =</span> <span class="st">"Top</span><span class="sc">\n</span><span class="st">Right"</span>,</span>
<span id="cb22-17"><a href="#cb22-17"></a>           <span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="dv">1</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb22-18"><a href="#cb22-18"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">label =</span> <span class="st">"45 degrees"</span>,</span>
<span id="cb22-19"><a href="#cb22-19"></a>           <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="fl">0.5</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">angle =</span> <span class="dv">45</span>) <span class="sc">+</span></span>
<span id="cb22-20"><a href="#cb22-20"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">label =</span> <span class="st">"90 degrees"</span>,</span>
<span id="cb22-21"><a href="#cb22-21"></a>           <span class="at">x =</span> <span class="fl">0.25</span>, <span class="at">y =</span> <span class="fl">0.5</span>, <span class="at">angle =</span> <span class="dv">90</span>) <span class="sc">+</span></span>
<span id="cb22-22"><a href="#cb22-22"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">label =</span> <span class="st">"270 degrees"</span>,</span>
<span id="cb22-23"><a href="#cb22-23"></a>           <span class="at">x =</span> <span class="fl">0.75</span>, <span class="at">y =</span> <span class="fl">0.5</span>, <span class="at">angle =</span> <span class="dv">270</span>)<span class="sc">+</span></span>
<span id="cb22-24"><a href="#cb22-24"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">label =</span> <span class="st">"-45 degrees"</span>,</span>
<span id="cb22-25"><a href="#cb22-25"></a>           <span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="fl">0.5</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">angle =</span> <span class="sc">-</span><span class="dv">45</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section><section id="other-annotations" class="level4" data-number="10.1.3.2"><h4 data-number="10.1.3.2" class="anchored" data-anchor-id="other-annotations">
<span class="header-section-number">10.1.3.2</span> Other annotations</h4>
<p>You can add other geoms to highlight parts of a plot. The example below adds a rectangle around a group of points, a text label, a straight arrow from the label to the rectangle, and a curved arrow from the label to an individual point.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>point <span class="sc">+</span></span>
<span id="cb23-2"><a href="#cb23-2"></a>  <span class="co"># add a rectangle surrounding long call times</span></span>
<span id="cb23-3"><a href="#cb23-3"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"rect"</span>,</span>
<span id="cb23-4"><a href="#cb23-4"></a>           <span class="at">xmin =</span> <span class="dv">100</span>, <span class="at">xmax =</span> <span class="dv">275</span>,</span>
<span id="cb23-5"><a href="#cb23-5"></a>           <span class="at">ymin =</span> <span class="dv">140</span>, <span class="at">ymax =</span> <span class="dv">180</span>,</span>
<span id="cb23-6"><a href="#cb23-6"></a>           <span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb23-7"><a href="#cb23-7"></a>  <span class="co"># add a text label</span></span>
<span id="cb23-8"><a href="#cb23-8"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>,</span>
<span id="cb23-9"><a href="#cb23-9"></a>           <span class="at">x =</span> <span class="dv">260</span>, <span class="at">y =</span> <span class="dv">120</span>,</span>
<span id="cb23-10"><a href="#cb23-10"></a>           <span class="at">label =</span> <span class="st">"outliers"</span>) <span class="sc">+</span></span>
<span id="cb23-11"><a href="#cb23-11"></a>  <span class="co"># add an line with an arrow from the text to the box</span></span>
<span id="cb23-12"><a href="#cb23-12"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"segment"</span>, </span>
<span id="cb23-13"><a href="#cb23-13"></a>           <span class="at">x =</span> <span class="dv">240</span>, <span class="at">y =</span> <span class="dv">120</span>, </span>
<span id="cb23-14"><a href="#cb23-14"></a>           <span class="at">xend =</span> <span class="dv">200</span>, <span class="at">yend =</span> <span class="dv">135</span>,</span>
<span id="cb23-15"><a href="#cb23-15"></a>           <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"lines"</span>))) <span class="sc">+</span></span>
<span id="cb23-16"><a href="#cb23-16"></a>  <span class="co"># add a curved line with an arrow </span></span>
<span id="cb23-17"><a href="#cb23-17"></a>  <span class="co"># from the text to a wait time outlier</span></span>
<span id="cb23-18"><a href="#cb23-18"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"curve"</span>, </span>
<span id="cb23-19"><a href="#cb23-19"></a>          <span class="at">x =</span> <span class="dv">280</span>, <span class="at">y =</span> <span class="dv">120</span>, </span>
<span id="cb23-20"><a href="#cb23-20"></a>          <span class="at">xend =</span> <span class="dv">320</span>, <span class="at">yend =</span> <span class="dv">45</span>,</span>
<span id="cb23-21"><a href="#cb23-21"></a>          <span class="at">curvature =</span> <span class="sc">-</span><span class="fl">0.5</span>,</span>
<span id="cb23-22"><a href="#cb23-22"></a>          <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"lines"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="images/figures/annotation-other-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Example of annotatins with the rect, text, segment, and curve geoms.</figcaption></figure>
</div>
</div>
</div>
<p>See the <code class="package"><a href="https://ggforce.data-imaginist.com/" target="_blank">ggforce</a></code> package for more sophisticated options, such as highlighting a group of points with an ellipse.</p>
</section></section><section id="sec-other-plots" class="level3" data-number="10.1.4"><h3 data-number="10.1.4" class="anchored" data-anchor-id="sec-other-plots">
<span class="header-section-number">10.1.4</span> Other Plots</h3>
<section id="interactive-plots" class="level4" data-number="10.1.4.1"><h4 data-number="10.1.4.1" class="anchored" data-anchor-id="interactive-plots">
<span class="header-section-number">10.1.4.1</span> Interactive Plots</h4>
<p>The <code class="package">plotly</code> package can be used to make interactive graphs. Assign your ggplot to a variable and then use the function <code>ggplotly()</code> on the plot object. Note that interactive plots only work in HTML files, not PDFs or Word files.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="fu">ggplotly</span>(point)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in ggplotly(point): could not find function "ggplotly"</code></pre>
</div>
</div>
<div class="info">
<p>Hover over the data points above and click on the legend items.</p>
</div>
</section><section id="waffle-plots" class="level4" data-number="10.1.4.2"><h4 data-number="10.1.4.2" class="anchored" data-anchor-id="waffle-plots">
<span class="header-section-number">10.1.4.2</span> Waffle Plots</h4>
<p>In Chapter&nbsp;@ref(ggplot), we mentioned that pie charts are such a poor way to visualise proportions that we refused to even show you how to make one. Waffle plots are a delicious alternative.</p>
<div class="warning">
<p>Use <code class="package">waffle</code> by <a href="https://github.com/hrbrmstr/waffle/">hrbrmstr on GitHub</a> using the <code>install_github()</code> function below, rather than the one on CRAN you get from using <code><a href="https://rdrr.io/r/utils/install.packages.html">install.packages()</a></code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"hrbrmstr/waffle"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>By default, <code>geom_waffle()</code> represents each observation with a tile and splits these across 10 rows. You can play about with the <code>n_rows</code> argument to determine what works best for your data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>survey_data <span class="sc">|&gt;</span> </span>
<span id="cb27-2"><a href="#cb27-2"></a>  <span class="fu">count</span>(issue_category) <span class="sc">|&gt;</span></span>
<span id="cb27-3"><a href="#cb27-3"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">fill =</span> issue_category, <span class="at">values =</span> n)) <span class="sc">+</span></span>
<span id="cb27-4"><a href="#cb27-4"></a>  <span class="fu">geom_waffle</span>(</span>
<span id="cb27-5"><a href="#cb27-5"></a>    <span class="at">n_rows =</span> <span class="dv">23</span>, <span class="co"># try setting this to 10 (the default)</span></span>
<span id="cb27-6"><a href="#cb27-6"></a>    <span class="at">size =</span> <span class="fl">0.33</span>, <span class="co"># line size</span></span>
<span id="cb27-7"><a href="#cb27-7"></a>    <span class="at">make_proportional =</span> <span class="cn">FALSE</span>, <span class="co"># use raw values</span></span>
<span id="cb27-8"><a href="#cb27-8"></a>    <span class="at">colour =</span> <span class="st">"white"</span>, <span class="co"># line colour</span></span>
<span id="cb27-9"><a href="#cb27-9"></a>    <span class="at">flip =</span> <span class="cn">FALSE</span>, <span class="co"># bottom-top or left-right</span></span>
<span id="cb27-10"><a href="#cb27-10"></a>    <span class="at">radius =</span> grid<span class="sc">::</span><span class="fu">unit</span>(<span class="fl">0.1</span>, <span class="st">"npc"</span>) <span class="co"># set to 0.5 for circles</span></span>
<span id="cb27-11"><a href="#cb27-11"></a>  ) <span class="sc">+</span></span>
<span id="cb27-12"><a href="#cb27-12"></a>  <span class="fu">theme_enhance_waffle</span>() <span class="sc">+</span> <span class="co"># gets rid of axes</span></span>
<span id="cb27-13"><a href="#cb27-13"></a>  <span class="fu">scale_fill_colorblind</span>(<span class="at">name =</span> <span class="st">"Issue Category"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in geom_waffle(n_rows = 23, size = 0.33, make_proportional = FALSE, : could not find function "geom_waffle"</code></pre>
</div>
</div>
<p>The waffle plot can also be used to display the counts as proportions To achieve these, set <code>n_rows = 10</code> and <code>make_proportional = TRUE</code>. Now, rather than each tile representing one observation, each tile represents 1% of the data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>survey_data <span class="sc">|&gt;</span> </span>
<span id="cb29-2"><a href="#cb29-2"></a>  <span class="fu">count</span>(issue_category) <span class="sc">|&gt;</span></span>
<span id="cb29-3"><a href="#cb29-3"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">fill =</span> issue_category, <span class="at">values =</span> n)) <span class="sc">+</span></span>
<span id="cb29-4"><a href="#cb29-4"></a>  <span class="fu">geom_waffle</span>(</span>
<span id="cb29-5"><a href="#cb29-5"></a>    <span class="at">n_rows =</span> <span class="dv">10</span>, </span>
<span id="cb29-6"><a href="#cb29-6"></a>    <span class="at">size =</span> <span class="fl">0.33</span>, </span>
<span id="cb29-7"><a href="#cb29-7"></a>    <span class="at">make_proportional =</span> <span class="cn">TRUE</span>, <span class="co"># compute proportions</span></span>
<span id="cb29-8"><a href="#cb29-8"></a>    <span class="at">colour =</span> <span class="st">"white"</span>, </span>
<span id="cb29-9"><a href="#cb29-9"></a>    <span class="at">flip =</span> <span class="cn">FALSE</span>, </span>
<span id="cb29-10"><a href="#cb29-10"></a>    <span class="at">radius =</span> grid<span class="sc">::</span><span class="fu">unit</span>(<span class="fl">0.1</span>, <span class="st">"npc"</span>) </span>
<span id="cb29-11"><a href="#cb29-11"></a>  ) <span class="sc">+</span></span>
<span id="cb29-12"><a href="#cb29-12"></a>  <span class="fu">theme_enhance_waffle</span>() <span class="sc">+</span> </span>
<span id="cb29-13"><a href="#cb29-13"></a>  <span class="fu">scale_fill_colorblind</span>(<span class="at">name =</span> <span class="st">"Issue Category"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in geom_waffle(n_rows = 10, size = 0.33, make_proportional = TRUE, : could not find function "geom_waffle"</code></pre>
</div>
</div>
</section><section id="treemap" class="level4" data-number="10.1.4.3"><h4 data-number="10.1.4.3" class="anchored" data-anchor-id="treemap">
<span class="header-section-number">10.1.4.3</span> Treemap</h4>
<p>Treemap plots are another way to visualise proportions. Like the waffle plots, you need to count the data by category first. You can use any <a href="https://www.datanovia.com/en/blog/the-a-z-of-rcolorbrewer-palette/">brewer palette</a> for the fill.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>survey_data <span class="sc">|&gt;</span> </span>
<span id="cb31-2"><a href="#cb31-2"></a>  <span class="fu">count</span>(issue_category) <span class="sc">|&gt;</span></span>
<span id="cb31-3"><a href="#cb31-3"></a>  <span class="fu">treemap</span>(</span>
<span id="cb31-4"><a href="#cb31-4"></a>    <span class="at">index =</span> <span class="st">"issue_category"</span>, <span class="co"># column with number of rectangles</span></span>
<span id="cb31-5"><a href="#cb31-5"></a>    <span class="at">vSize =</span> <span class="st">"n"</span>, <span class="co"># column with size of rectangle</span></span>
<span id="cb31-6"><a href="#cb31-6"></a>    <span class="at">title =</span> <span class="st">""</span>,</span>
<span id="cb31-7"><a href="#cb31-7"></a>    <span class="at">palette =</span> <span class="st">"BuPu"</span>,</span>
<span id="cb31-8"><a href="#cb31-8"></a>    <span class="at">inflate.labels =</span> <span class="cn">TRUE</span> <span class="co"># expand labels to size of rectangle</span></span>
<span id="cb31-9"><a href="#cb31-9"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in treemap(count(survey_data, issue_category), index = "issue_category", : could not find function "treemap"</code></pre>
</div>
</div>
<p>You can also represent multiple categories with treemaps</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>survey_data <span class="sc">|&gt;</span> </span>
<span id="cb33-2"><a href="#cb33-2"></a>  <span class="fu">count</span>(issue_category, employee_id) <span class="sc">|&gt;</span></span>
<span id="cb33-3"><a href="#cb33-3"></a>  <span class="fu">arrange</span>(employee_id) <span class="sc">|&gt;</span></span>
<span id="cb33-4"><a href="#cb33-4"></a>  <span class="fu">treemap</span>(</span>
<span id="cb33-5"><a href="#cb33-5"></a>    <span class="co"># use c() to specify two variables</span></span>
<span id="cb33-6"><a href="#cb33-6"></a>    <span class="at">index =</span> <span class="fu">c</span>(<span class="st">"employee_id"</span>, <span class="st">"issue_category"</span>), </span>
<span id="cb33-7"><a href="#cb33-7"></a>    <span class="at">vSize =</span> <span class="st">"n"</span>, </span>
<span id="cb33-8"><a href="#cb33-8"></a>    <span class="at">title =</span> <span class="st">""</span>,</span>
<span id="cb33-9"><a href="#cb33-9"></a>    <span class="at">palette =</span> <span class="st">"Dark2"</span>,</span>
<span id="cb33-10"><a href="#cb33-10"></a>    <span class="co"># set different label sizes for each type of label</span></span>
<span id="cb33-11"><a href="#cb33-11"></a>    <span class="at">fontsize.labels =</span> <span class="fu">c</span>(<span class="dv">30</span>, <span class="dv">10</span>), </span>
<span id="cb33-12"><a href="#cb33-12"></a>    <span class="co"># set different alignments for two label types</span></span>
<span id="cb33-13"><a href="#cb33-13"></a>    <span class="at">align.labels =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">"left"</span>, <span class="st">"top"</span>), <span class="fu">c</span>(<span class="st">"center"</span>, <span class="st">"center"</span>)) </span>
<span id="cb33-14"><a href="#cb33-14"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in treemap(arrange(count(survey_data, issue_category, employee_id), : could not find function "treemap"</code></pre>
</div>
</div>
</section><section id="bump-plots" class="level4" data-number="10.1.4.4"><h4 data-number="10.1.4.4" class="anchored" data-anchor-id="bump-plots">
<span class="header-section-number">10.1.4.4</span> Bump Plots</h4>
<p>Bump plots are very useful for visualising how rankings change over time. So first, we need to get some ranking data. Let’s start with a more typical raw data table, containing an identifying column of <code>person</code> and three columns for their scores each week</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="co"># make a small dataset of scores for 3 people over 3 weeks</span></span>
<span id="cb35-2"><a href="#cb35-2"></a>score_data <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb35-3"><a href="#cb35-3"></a>  <span class="sc">~</span>person, <span class="sc">~</span>week_1, <span class="sc">~</span>week_2, <span class="sc">~</span>week_3,</span>
<span id="cb35-4"><a href="#cb35-4"></a>  <span class="st">"Abeni"</span>,      <span class="dv">80</span>,     <span class="dv">75</span>,       <span class="dv">90</span>,</span>
<span id="cb35-5"><a href="#cb35-5"></a>  <span class="st">"Beth"</span>,       <span class="dv">75</span>,     <span class="dv">85</span>,       <span class="dv">75</span>,</span>
<span id="cb35-6"><a href="#cb35-6"></a>  <span class="st">"Carmen"</span>,     <span class="dv">60</span>,     <span class="dv">70</span>,       <span class="dv">80</span></span>
<span id="cb35-7"><a href="#cb35-7"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we make the table long, group by week, and use the <code><a href="https://rdrr.io/r/base/rank.html">rank()</a></code> function to find the rank of each person’s score each week. Use <code>n() - rank(score) + 1</code> to reverse the ranks so that the highest score gets rank 1. We also need to make the <code>week</code> variable a number.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="co"># calculate ranks</span></span>
<span id="cb36-2"><a href="#cb36-2"></a>rank_data <span class="ot">&lt;-</span> score_data <span class="sc">|&gt;</span></span>
<span id="cb36-3"><a href="#cb36-3"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>person,</span>
<span id="cb36-4"><a href="#cb36-4"></a>               <span class="at">names_to =</span> <span class="st">"week"</span>,</span>
<span id="cb36-5"><a href="#cb36-5"></a>               <span class="at">values_to =</span> <span class="st">"score"</span>) <span class="sc">|&gt;</span></span>
<span id="cb36-6"><a href="#cb36-6"></a>  <span class="fu">group_by</span>(week) <span class="sc">|&gt;</span></span>
<span id="cb36-7"><a href="#cb36-7"></a>  <span class="fu">mutate</span>(<span class="at">rank =</span> <span class="fu">n</span>() <span class="sc">-</span> <span class="fu">rank</span>(score) <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb36-8"><a href="#cb36-8"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb36-9"><a href="#cb36-9"></a>  <span class="fu">arrange</span>(week, rank) <span class="sc">|&gt;</span></span>
<span id="cb36-10"><a href="#cb36-10"></a>  <span class="fu">mutate</span>(<span class="at">week =</span> <span class="fu">str_replace</span>(week, <span class="st">"week_"</span>, <span class="st">""</span>) <span class="sc">|&gt;</span> <span class="fu">as.integer</span>())</span>
<span id="cb36-11"><a href="#cb36-11"></a></span>
<span id="cb36-12"><a href="#cb36-12"></a>rank_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">person</th>
<th style="text-align: right;">week</th>
<th style="text-align: right;">score</th>
<th style="text-align: right;">rank</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Abeni</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">80</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Beth</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">75</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Carmen</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">60</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">Beth</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">85</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Abeni</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">75</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Carmen</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">70</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Abeni</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">90</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Carmen</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">80</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Beth</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">75</td>
<td style="text-align: right;">3</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>A typical mapping for a bump plot puts the time variable in the x-axis, the rank variable on the y-axis, and sets colour to the identifying variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> rank_data, </span>
<span id="cb37-2"><a href="#cb37-2"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> week, </span>
<span id="cb37-3"><a href="#cb37-3"></a>                     <span class="at">y =</span> rank, </span>
<span id="cb37-4"><a href="#cb37-4"></a>                     <span class="at">colour =</span> person)) <span class="sc">+</span></span>
<span id="cb37-5"><a href="#cb37-5"></a>  ggbump<span class="sc">::</span><span class="fu">geom_bump</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in loadNamespace(x): there is no package called 'ggbump'</code></pre>
</div>
</div>
<p>We can make this more attractive by customising the axes and adding text labels. Try running each line of this code to see how it builds up.</p>
<ul>
<li>Add <code>label = person</code> to the mapping so we can add in text labels.</li>
<li>Increase the size of the lines with the <code>size</code> argument to <code>geom_bump()</code>
</li>
<li>We don’t need labels for weeks 1.5 and 2.5, so change the x-axis <code>breaks</code>
</li>
<li>The <code>expand</code> argument for the two scale_ functions expands the plot area so we can fit text labels to the right.</li>
<li>It makes more sense to have first place at the top, so reverse the order of the y-axis with <code>scale_y_reverse()</code> and fix the breaks and expansion.</li>
<li>Add text labels with <code>geom_text()</code>, but just for week 3, so set <code>data =  filter(rank_data, week == 3)</code> for this geom.</li>
<li>Set <code>x = 3.05</code> to move the text labels just to the right of week 3, and set <code>hjust = 0</code> to right-justify the text labels (the default is <code>hjust = 0.5</code>, which would center them on 3.05).</li>
<li>Remove the legend and grid lines. Increase the x-axis text size.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> rank_data, </span>
<span id="cb39-2"><a href="#cb39-2"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> week, </span>
<span id="cb39-3"><a href="#cb39-3"></a>                     <span class="at">y =</span> rank, </span>
<span id="cb39-4"><a href="#cb39-4"></a>                     <span class="at">colour =</span> person,</span>
<span id="cb39-5"><a href="#cb39-5"></a>                     <span class="at">label =</span> person)) <span class="sc">+</span></span>
<span id="cb39-6"><a href="#cb39-6"></a>  ggbump<span class="sc">::</span><span class="fu">geom_bump</span>(<span class="at">size =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb39-7"><a href="#cb39-7"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">""</span>,</span>
<span id="cb39-8"><a href="#cb39-8"></a>                     <span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, </span>
<span id="cb39-9"><a href="#cb39-9"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Week 1"</span>, <span class="st">"Week 2"</span>, <span class="st">"Week 3"</span>),</span>
<span id="cb39-10"><a href="#cb39-10"></a>                     <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="fu">c</span>(.<span class="dv">05</span>, .<span class="dv">2</span>))) <span class="sc">+</span></span>
<span id="cb39-11"><a href="#cb39-11"></a>  <span class="fu">scale_y_reverse</span>(<span class="at">name =</span> <span class="st">"Ranking"</span>,</span>
<span id="cb39-12"><a href="#cb39-12"></a>                  <span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, </span>
<span id="cb39-13"><a href="#cb39-13"></a>                  <span class="at">expand =</span> <span class="fu">expansion</span>(.<span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb39-14"><a href="#cb39-14"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> <span class="fu">filter</span>(rank_data, week <span class="sc">==</span> <span class="dv">3</span>),</span>
<span id="cb39-15"><a href="#cb39-15"></a>            <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">x =</span> <span class="fl">3.05</span>, <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb39-16"><a href="#cb39-16"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb39-17"><a href="#cb39-17"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb39-18"><a href="#cb39-18"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb39-19"><a href="#cb39-19"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in loadNamespace(x): there is no package called 'ggbump'</code></pre>
</div>
</div>
</section><section id="word-clouds" class="level4" data-number="10.1.4.5"><h4 data-number="10.1.4.5" class="anchored" data-anchor-id="word-clouds">
<span class="header-section-number">10.1.4.5</span> Word Clouds</h4>
<p>Word clouds are a common way to summarise text data. First, download <a href="https://psyteachr.github.io/reprores-v5/data/amazon_alexa.csv" download="">amazon_alexa.csv</a> into your data folder and then load it into an object. This dataset contains text reviews as well as the 1-5 rating from customers who bought an Alexa device on Amazon.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="co"># https://www.kaggle.com/sid321axn/amazon-alexa-reviews</span></span>
<span id="cb41-2"><a href="#cb41-2"></a><span class="co"># extracted from Amazon by Manu Siddhartha &amp; Anurag Bhatt</span></span>
<span id="cb41-3"><a href="#cb41-3"></a>alexa <span class="ot">&lt;-</span> rio<span class="sc">::</span><span class="fu">import</span>(<span class="st">"data/amazon_alexa.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can use this data to look at how the words used differ depending on the rating given. To make the text data easy to work with, the function <code><a href="https://juliasilge.github.io/tidytext/reference/unnest_tokens.html">tidytext::unnest_tokens()</a></code> splits the words in the <code>input</code> column into individual words in a new <code>output</code> column. <code>unnnest_tokens()</code> is particularly helpful because it also does things like removes punctuation and transforms all words to lower case to make it easier to work with. Compare <code>words</code> and <code>alexa</code> to see how they map on to each other.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a>words <span class="ot">&lt;-</span> alexa <span class="sc">|&gt;</span></span>
<span id="cb42-2"><a href="#cb42-2"></a>  <span class="fu">unnest_tokens</span>(<span class="at">output =</span> <span class="st">"word"</span>, <span class="at">input =</span> <span class="st">"verified_reviews"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can then add another line of code using a pipe that counts how many instances of each word there is by rating to give us the most popular words.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a>words <span class="ot">&lt;-</span> alexa <span class="sc">|&gt;</span></span>
<span id="cb43-2"><a href="#cb43-2"></a>  <span class="fu">unnest_tokens</span>(<span class="at">output =</span> <span class="st">"word"</span>, <span class="at">input =</span> <span class="st">"verified_reviews"</span>) <span class="sc">|&gt;</span></span>
<span id="cb43-3"><a href="#cb43-3"></a>  <span class="fu">count</span>(word, rating, <span class="at">sort =</span> <span class="cn">TRUE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">word</th>
<th style="text-align: right;">rating</th>
<th style="text-align: right;">n</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">i</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1859</td>
</tr>
<tr class="even">
<td style="text-align: left;">the</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1839</td>
</tr>
<tr class="odd">
<td style="text-align: left;">to</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1633</td>
</tr>
<tr class="even">
<td style="text-align: left;">it</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1571</td>
</tr>
<tr class="odd">
<td style="text-align: left;">and</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1477</td>
</tr>
<tr class="even">
<td style="text-align: left;">my</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">980</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>The problem is that the most common words are all function words rather than content words, which makes sense because these words have the highest word frequency in natural language.</p>
<p>Helpfully, <code>tidytext</code> contains a list of common “stop words”, i.e., words that you want to ignore, that are stored in an object named <code>stop_words</code>. It is also very useful to define a list of custom stop words based upon the unique properties of your data (it can sometimes take a few attempts to identify what’s appropriate for your dataset). This dataset contains a lot of numbers that aren’t informative, and it also contains “https” from website links, so we’ll get rid of both with a custom stop list.</p>
<p>Once you have defined your stop words, you can then use <code>anti_join()</code> to remove any <code>word</code> that is present in the stop word list.</p>
<p>To get the top 25 words, we then group by rating and use <code><a href="https://dplyr.tidyverse.org/reference/slice.html">dplyr::slice_max()</a></code>, ordered by the column <code>n</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a>custom_stop <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">word =</span> <span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">9</span>, <span class="st">"https"</span>, <span class="dv">34</span>))</span>
<span id="cb44-2"><a href="#cb44-2"></a></span>
<span id="cb44-3"><a href="#cb44-3"></a>words <span class="ot">&lt;-</span> alexa <span class="sc">|&gt;</span></span>
<span id="cb44-4"><a href="#cb44-4"></a>  <span class="fu">unnest_tokens</span>(<span class="at">output =</span> <span class="st">"word"</span>, <span class="at">input =</span> <span class="st">"verified_reviews"</span>) <span class="sc">|&gt;</span></span>
<span id="cb44-5"><a href="#cb44-5"></a>  <span class="fu">count</span>(word, rating) <span class="sc">|&gt;</span></span>
<span id="cb44-6"><a href="#cb44-6"></a>  <span class="fu">anti_join</span>(stop_words, <span class="at">by =</span> <span class="st">"word"</span>) <span class="sc">|&gt;</span></span>
<span id="cb44-7"><a href="#cb44-7"></a>  <span class="fu">anti_join</span>(custom_stop, <span class="at">by =</span> <span class="st">"word"</span>) <span class="sc">|&gt;</span></span>
<span id="cb44-8"><a href="#cb44-8"></a>  <span class="fu">group_by</span>(rating) <span class="sc">|&gt;</span></span>
<span id="cb44-9"><a href="#cb44-9"></a>  <span class="fu">slice_max</span>(<span class="at">order_by =</span> n, <span class="at">n =</span> <span class="dv">25</span>, <span class="at">with_ties =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<span id="cb44-10"><a href="#cb44-10"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>First, let’s make a word cloud for customers who gave a 1-star rating:</p>
<ul>
<li>Filter retains only the data for 1-star ratings.</li>
<li>
<code>label</code> comes from the <code>word</code> column and is the data to plot (i.e., the words).</li>
<li>
<code>colour</code> makes the words red (you could also set this to <code>word</code> to give each word a different colour or <code>n</code> to vary colour continuously by frequency).</li>
<li>
<code>size</code> makes the size of the word proportional to <code>n</code>, the number of times the word appeared.</li>
<li>
<code><span><span class="fu">ggwordcloud</span><span class="fu">::</span><span class="fu"><a target="_blank" href="https://lepennec.github.io/ggwordcloud/reference/geom_text_wordcloud.html">geom_text_wordcloud_area</a></span><span class="op">(</span><span class="op">)</span></span></code> is the word cloud geom.</li>
<li>
<code><span><span class="fu">ggwordcloud</span><span class="fu">::</span><span class="fu">scale_size_area</span><span class="op">(</span><span class="op">)</span></span></code> controls how big the word cloud is (this usually takes some trial-and-error).</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a>rating1 <span class="ot">&lt;-</span> <span class="fu">filter</span>(words, rating <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb45-2"><a href="#cb45-2"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">label =</span> word, <span class="at">colour =</span> <span class="st">"red"</span>, <span class="at">size =</span> n)) <span class="sc">+</span></span>
<span id="cb45-3"><a href="#cb45-3"></a>  <span class="fu">geom_text_wordcloud_area</span>() <span class="sc">+</span></span>
<span id="cb45-4"><a href="#cb45-4"></a>  <span class="fu">scale_size_area</span>(<span class="at">max_size =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb45-5"><a href="#cb45-5"></a>  <span class="fu">ggtitle</span>(<span class="st">"Rating = 1"</span>) <span class="sc">+</span></span>
<span id="cb45-6"><a href="#cb45-6"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>)</span>
<span id="cb45-7"><a href="#cb45-7"></a></span>
<span id="cb45-8"><a href="#cb45-8"></a>rating1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="images/figures/unnamed-chunk-21-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>We can now do the same but for 5-star ratings and paste the plots together with <code>patchwork</code> (word clouds don’t play well with facets).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a>rating5 <span class="ot">&lt;-</span> <span class="fu">filter</span>(words, rating <span class="sc">==</span> <span class="dv">5</span>) <span class="sc">|&gt;</span></span>
<span id="cb46-2"><a href="#cb46-2"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">label =</span> word, <span class="at">size =</span> n)) <span class="sc">+</span></span>
<span id="cb46-3"><a href="#cb46-3"></a>  <span class="fu">geom_text_wordcloud_area</span>(<span class="at">colour =</span> <span class="st">"darkolivegreen3"</span>) <span class="sc">+</span></span>
<span id="cb46-4"><a href="#cb46-4"></a>  <span class="fu">scale_size_area</span>(<span class="at">max_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb46-5"><a href="#cb46-5"></a>  <span class="fu">ggtitle</span>(<span class="st">"Rating = 5"</span>) <span class="sc">+</span></span>
<span id="cb46-6"><a href="#cb46-6"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>)</span>
<span id="cb46-7"><a href="#cb46-7"></a></span>
<span id="cb46-8"><a href="#cb46-8"></a>rating1 <span class="sc">+</span> rating5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="images/figures/unnamed-chunk-22-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Word cloud.</figcaption></figure>
</div>
</div>
</div>
<div class="warning">
<p>It’s worth highlighting that whilst word clouds are very common, they’re really the equivalent of pie charts for text data because we’re not very good at making accurate comparisons based on size. You might be able to see what’s the most popular word, but can you accurately determine the 2nd, 3rd, 4th or 5th most popular word based on the clouds alone? There’s also the issue that just because it’s text data doesn’t make it a qualitative analysis and just because something is said a lot doesn’t mean it’s useful or important. But, this argument is outwith the scope of this book, even if it is a recurring part of Emily’s life thanks to her qualitative wife.</p>
</div>
</section><section id="maps" class="level4" data-number="10.1.4.6"><h4 data-number="10.1.4.6" class="anchored" data-anchor-id="maps">
<span class="header-section-number">10.1.4.6</span> Maps</h4>
<p>Working with maps can be tricky. The <code class="package">sf</code> package provides functions that work with <code class="package">ggplot2</code>, such as <code>geom_sf()</code>. The <code class="package">rnaturalearth</code> package (and associated data packages that you may be prompted to download) provide high-quality mapping coordinates.</p>
<ul>
<li>
<code>ne_countries()</code> returns world country polygons (i.e., a world map). We specify the object should be returned as a “simple feature” class <code>sf</code> so that it will work with <code>geom_sf()</code>. If you would like a deep dive on simple feature objects, check out a <a href="https://r-spatial.github.io/sf/articles/sf1.html">vignette</a> from the <code class="package">sf</code> package.</li>
<li>It’s worth checking out what the object <code>ne_countries()</code> returns to see just how much information is available.</li>
<li>Try changing the values and colours below to get a sense of how the code works.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a><span class="co"># get the world map coordinates</span></span>
<span id="cb47-2"><a href="#cb47-2"></a>world_sf <span class="ot">&lt;-</span> <span class="fu">ne_countries</span>(<span class="at">returnclass =</span> <span class="st">"sf"</span>, <span class="at">scale =</span> <span class="st">"medium"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in ne_countries(returnclass = "sf", scale = "medium"): could not find function "ne_countries"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a><span class="co"># plot them on a light blue background</span></span>
<span id="cb49-2"><a href="#cb49-2"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb49-3"><a href="#cb49-3"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> world_sf, <span class="at">size =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb49-4"><a href="#cb49-4"></a>  <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"lightskyblue2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error: object 'world_sf' not found</code></pre>
</div>
</div>
<p>You can combine multiple countries using <code>bind_rows()</code> and visualise them with different colours for each country.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a><span class="co"># get and bind country data</span></span>
<span id="cb51-2"><a href="#cb51-2"></a>uk_sf <span class="ot">&lt;-</span> <span class="fu">ne_states</span>(<span class="at">country =</span> <span class="st">"united kingdom"</span>, <span class="at">returnclass =</span> <span class="st">"sf"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in ne_states(country = "united kingdom", returnclass = "sf"): could not find function "ne_states"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a>ireland_sf <span class="ot">&lt;-</span> <span class="fu">ne_states</span>(<span class="at">country =</span> <span class="st">"ireland"</span>, <span class="at">returnclass =</span> <span class="st">"sf"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in ne_states(country = "ireland", returnclass = "sf"): could not find function "ne_states"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a>islands <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(uk_sf, ireland_sf) <span class="sc">|&gt;</span></span>
<span id="cb55-2"><a href="#cb55-2"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(geonunit))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error: object 'uk_sf' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a><span class="co"># set colours</span></span>
<span id="cb57-2"><a href="#cb57-2"></a>country_colours <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Scotland"</span> <span class="ot">=</span> <span class="st">"#0962BA"</span>,</span>
<span id="cb57-3"><a href="#cb57-3"></a>                     <span class="st">"Wales"</span> <span class="ot">=</span> <span class="st">"#00AC48"</span>,</span>
<span id="cb57-4"><a href="#cb57-4"></a>                     <span class="st">"England"</span> <span class="ot">=</span> <span class="st">"#FF0000"</span>,</span>
<span id="cb57-5"><a href="#cb57-5"></a>                     <span class="st">"Northern Ireland"</span> <span class="ot">=</span> <span class="st">"#FFCD2C"</span>,</span>
<span id="cb57-6"><a href="#cb57-6"></a>                     <span class="st">"Ireland"</span> <span class="ot">=</span> <span class="st">"#F77613"</span>)</span>
<span id="cb57-7"><a href="#cb57-7"></a></span>
<span id="cb57-8"><a href="#cb57-8"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb57-9"><a href="#cb57-9"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> islands,</span>
<span id="cb57-10"><a href="#cb57-10"></a>          <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">fill =</span> geonunit),</span>
<span id="cb57-11"><a href="#cb57-11"></a>          <span class="at">colour =</span> <span class="cn">NA</span>,</span>
<span id="cb57-12"><a href="#cb57-12"></a>          <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb57-13"><a href="#cb57-13"></a>  <span class="fu">coord_sf</span>(<span class="at">crs =</span> sf<span class="sc">::</span><span class="fu">st_crs</span>(<span class="dv">4326</span>),</span>
<span id="cb57-14"><a href="#cb57-14"></a>           <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">10.7</span>, <span class="fl">2.1</span>), </span>
<span id="cb57-15"><a href="#cb57-15"></a>           <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">49.7</span>, <span class="dv">61</span>)) <span class="sc">+</span></span>
<span id="cb57-16"><a href="#cb57-16"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">"Country"</span>, </span>
<span id="cb57-17"><a href="#cb57-17"></a>                    <span class="at">values =</span> country_colours)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in `fortify()`:
! `data` must be a &lt;data.frame&gt;, or an object coercible by `fortify()`,
  or a valid &lt;data.frame&gt;-like object coercible by `as.data.frame()`.
Caused by error in `.prevalidate_data_frame_like_object()`:
! `dim(data)` must return an &lt;integer&gt; of length 2.</code></pre>
</div>
</div>
<p>You can join <a href="https://psyteachr.github.io/reprores-v5/data/scottish_population.csv" download="">Scottish population data</a> to the map table to visualise data on the map using colours or labels.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a><span class="co"># load map data</span></span>
<span id="cb59-2"><a href="#cb59-2"></a>scotland_sf <span class="ot">&lt;-</span> <span class="fu">ne_states</span>(<span class="at">geounit =</span> <span class="st">"Scotland"</span>, </span>
<span id="cb59-3"><a href="#cb59-3"></a>                         <span class="at">returnclass =</span> <span class="st">"sf"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in ne_states(geounit = "Scotland", returnclass = "sf"): could not find function "ne_states"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a><span class="co"># load population data from</span></span>
<span id="cb61-2"><a href="#cb61-2"></a><span class="co"># https://www.indexmundi.com/facts/united-kingdom/quick-facts/scotland/population</span></span>
<span id="cb61-3"><a href="#cb61-3"></a>scotpop <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/scottish_population.csv"</span>, </span>
<span id="cb61-4"><a href="#cb61-4"></a>                    <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span>
<span id="cb61-5"><a href="#cb61-5"></a></span>
<span id="cb61-6"><a href="#cb61-6"></a><span class="co"># join data and fix typo in the map</span></span>
<span id="cb61-7"><a href="#cb61-7"></a>scotmap_pop <span class="ot">&lt;-</span> scotland_sf <span class="sc">|&gt;</span></span>
<span id="cb61-8"><a href="#cb61-8"></a>  <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">ifelse</span>(name <span class="sc">==</span> <span class="st">"North Ayshire"</span>, </span>
<span id="cb61-9"><a href="#cb61-9"></a>                       <span class="at">yes =</span> <span class="st">"North Ayrshire"</span>, </span>
<span id="cb61-10"><a href="#cb61-10"></a>                       <span class="at">no =</span> name)) <span class="sc">|&gt;</span></span>
<span id="cb61-11"><a href="#cb61-11"></a>  <span class="fu">left_join</span>(scotpop, <span class="at">by =</span> <span class="st">"name"</span>) <span class="sc">|&gt;</span></span>
<span id="cb61-12"><a href="#cb61-12"></a>  <span class="fu">select</span>(name, population, geometry)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error: object 'scotland_sf' not found</code></pre>
</div>
</div>
<div class="warning">
<p>There is a typo in the data from <code class="package">rnaturalearth</code>, so you need to change “North Ayshire” to “North Ayrshire” before you join the population data.</p>
</div>
<ul>
<li>Setting the fill to population in <code>geom_sf()</code> gives each region a colour based on its population.</li>
<li>The colours are customised with <code>scale_fill_viridis_c()</code>. The breaks of the fill scale are set to increments of 100K (1e5 in scientific notation) and the scale is set to span 0 to 600K.</li>
<li>
<code><a href="https://rdrr.io/r/base/paste.html">paste0()</a></code> creates the labels by taking the numbers 0 through 6 and adding “00 k” to them.</li>
<li>Finally, the position of the legend is moved into the sea using <code>legend.position()</code>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a><span class="co"># plot</span></span>
<span id="cb63-2"><a href="#cb63-2"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb63-3"><a href="#cb63-3"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> scotmap_pop,</span>
<span id="cb63-4"><a href="#cb63-4"></a>          <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">fill =</span> population),</span>
<span id="cb63-5"><a href="#cb63-5"></a>          <span class="at">color =</span> <span class="st">"white"</span>, </span>
<span id="cb63-6"><a href="#cb63-6"></a>          <span class="at">size =</span> .<span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb63-7"><a href="#cb63-7"></a>  <span class="fu">coord_sf</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">8</span>, <span class="dv">0</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">54</span>, <span class="dv">61</span>)) <span class="sc">+</span></span>
<span id="cb63-8"><a href="#cb63-8"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">name =</span> <span class="st">"Population"</span>,</span>
<span id="cb63-9"><a href="#cb63-9"></a>                       <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="fl">6e5</span>, <span class="at">by =</span> <span class="fl">1e5</span>), </span>
<span id="cb63-10"><a href="#cb63-10"></a>                       <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">6e5</span>),</span>
<span id="cb63-11"><a href="#cb63-11"></a>                       <span class="at">labels =</span> <span class="fu">paste0</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">6</span>, <span class="st">"00 K"</span>)) <span class="sc">+</span></span>
<span id="cb63-12"><a href="#cb63-12"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.16</span>, <span class="fl">0.84</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error: object 'scotmap_pop' not found</code></pre>
</div>
</div>
</section><section id="animated-plots" class="level4" data-number="10.1.4.7"><h4 data-number="10.1.4.7" class="anchored" data-anchor-id="animated-plots">
<span class="header-section-number">10.1.4.7</span> Animated Plots</h4>
<p>Animated plots are a great way to add a wow factor to your reports, but they can be complex to make, distracting, and not very accessible, so use them sparingly and only for data visualisation where the animation really adds something. The package <code class="package"><a href="https://gganimate.com/" target="_blank">gganimate</a></code> has many functions for animating ggplots.</p>
<p>Here, we’ll load some population data from the United Nations. <a href="data/WPP2019_POP_F01_1_TOTAL_POPULATION_BOTH_SEXES.xlsx" download="">Download the file</a> into your data folder and open it in Excel first to see what it looks like. The code below gets the data from the first tab, filters it to just the 6 world regions, makes the data long, and makes sure the <code>year</code> column is numeric and the <code>pop</code> column shows population in whole numbers (the original data is in 1000s).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a><span class="co"># load and process data</span></span>
<span id="cb65-2"><a href="#cb65-2"></a>worldpop <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"data/WPP2019_POP_F01_1_TOTAL_POPULATION_BOTH_SEXES.xlsx"</span>, <span class="at">skip =</span> <span class="dv">16</span>) <span class="sc">|&gt;</span></span>
<span id="cb65-3"><a href="#cb65-3"></a>  <span class="fu">filter</span>(Type <span class="sc">==</span> <span class="st">"Region"</span>) <span class="sc">|&gt;</span></span>
<span id="cb65-4"><a href="#cb65-4"></a>  <span class="fu">select</span>(<span class="at">region =</span> <span class="dv">3</span>, <span class="st">`</span><span class="at">1950</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">1992</span><span class="st">`</span>) <span class="sc">|&gt;</span></span>
<span id="cb65-5"><a href="#cb65-5"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>region, </span>
<span id="cb65-6"><a href="#cb65-6"></a>               <span class="at">names_to =</span> <span class="st">"year"</span>,</span>
<span id="cb65-7"><a href="#cb65-7"></a>               <span class="at">values_to =</span> <span class="st">"pop"</span>) <span class="sc">|&gt;</span></span>
<span id="cb65-8"><a href="#cb65-8"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">as.integer</span>(year),</span>
<span id="cb65-9"><a href="#cb65-9"></a>         <span class="at">pop =</span> <span class="fu">round</span>(<span class="dv">1000</span> <span class="sc">*</span> <span class="fu">as.numeric</span>(pop)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s make an animated plot showing how the population in each region changes with year. First, make a static plot. Filter the data to the most recent year so you can see what a single frame of the animation will look like.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a>worldpop <span class="sc">|&gt;</span></span>
<span id="cb66-2"><a href="#cb66-2"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">1992</span>) <span class="sc">|&gt;</span></span>
<span id="cb66-3"><a href="#cb66-3"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> region, <span class="at">y =</span> pop, <span class="at">fill =</span> region)) <span class="sc">+</span></span>
<span id="cb66-4"><a href="#cb66-4"></a>  <span class="fu">geom_col</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb66-5"><a href="#cb66-5"></a>  <span class="fu">scale_fill_viridis_d</span>() <span class="sc">+</span></span>
<span id="cb66-6"><a href="#cb66-6"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">name =</span> <span class="st">""</span>, </span>
<span id="cb66-7"><a href="#cb66-7"></a>                   <span class="at">guide =</span> <span class="fu">guide_axis</span>(<span class="at">n.dodge=</span><span class="dv">2</span>))<span class="sc">+</span></span>
<span id="cb66-8"><a href="#cb66-8"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">"Population"</span>,</span>
<span id="cb66-9"><a href="#cb66-9"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">3e9</span>, <span class="fl">1e9</span>),</span>
<span id="cb66-10"><a href="#cb66-10"></a>                     <span class="at">labels =</span> <span class="fu">paste0</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">3</span>, <span class="st">"B"</span>)) <span class="sc">+</span></span>
<span id="cb66-11"><a href="#cb66-11"></a>  <span class="fu">ggtitle</span>(<span class="st">'Year: 1992'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="images/figures/unnamed-chunk-25-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>To convert this to an animated plot that shows the data from multiple years:</p>
<ul>
<li>Remove the filter and add <code>transition_time(year)</code>.</li>
<li>Use the <code><a href="https://rdrr.io/r/base/Paren.html">{}</a></code> syntax to include the <code>frame_time</code> in the title.</li>
<li>Use <code>anim_save()</code> to save the animation to a GIF file and set this code chunk to <code>eval = FALSE</code> because creating an animation takes a long time and you don’t want to have to run it every time you knit your report.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a>anim <span class="ot">&lt;-</span> worldpop <span class="sc">|&gt;</span></span>
<span id="cb67-2"><a href="#cb67-2"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> region, <span class="at">y =</span> pop, <span class="at">fill =</span> region)) <span class="sc">+</span></span>
<span id="cb67-3"><a href="#cb67-3"></a>  <span class="fu">geom_col</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb67-4"><a href="#cb67-4"></a>  <span class="fu">scale_fill_viridis_d</span>() <span class="sc">+</span></span>
<span id="cb67-5"><a href="#cb67-5"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">name =</span> <span class="st">""</span>,</span>
<span id="cb67-6"><a href="#cb67-6"></a>                   <span class="at">guide =</span> <span class="fu">guide_axis</span>(<span class="at">n.dodge=</span><span class="dv">2</span>))<span class="sc">+</span></span>
<span id="cb67-7"><a href="#cb67-7"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">"Population"</span>,</span>
<span id="cb67-8"><a href="#cb67-8"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">3e9</span>, <span class="fl">1e9</span>),</span>
<span id="cb67-9"><a href="#cb67-9"></a>                     <span class="at">labels =</span> <span class="fu">paste0</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">3</span>, <span class="st">"B"</span>)) <span class="sc">+</span></span>
<span id="cb67-10"><a href="#cb67-10"></a>  <span class="fu">ggtitle</span>(<span class="st">'Year: {frame_time}'</span>) <span class="sc">+</span></span>
<span id="cb67-11"><a href="#cb67-11"></a>  <span class="fu">transition_time</span>(year)</span>
<span id="cb67-12"><a href="#cb67-12"></a>  </span>
<span id="cb67-13"><a href="#cb67-13"></a><span class="fu">dir.create</span>(<span class="st">"images"</span>, <span class="cn">FALSE</span>) <span class="co"># creates an images directory if needed</span></span>
<span id="cb67-14"><a href="#cb67-14"></a></span>
<span id="cb67-15"><a href="#cb67-15"></a><span class="fu">anim_save</span>(<span class="at">filename =</span> <span class="st">"images/gganim-demo.gif"</span>,</span>
<span id="cb67-16"><a href="#cb67-16"></a>          <span class="at">animation =</span> anim,</span>
<span id="cb67-17"><a href="#cb67-17"></a>          <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">5</span>, <span class="at">units =</span> <span class="st">"in"</span>, <span class="at">res =</span> <span class="dv">150</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can show your animated gif in an html report (animations don’t work in Word or a PDF) using <code>include_graphics()</code>, or include the GIF in a dynamic document like PowerPoint.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"images/gganim-demo.gif"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="images/gganim-demo.gif" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Animated gif.</figcaption></figure>
</div>
</div>
</div>
<div class="warning">
<p>There are actually not many plots that are really improved by animating them. The plot below gives the same information at a single glance.</p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="images/figures/anim-alternative-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</section></section><section id="resources-custom" class="level3" data-number="10.1.5"><h3 data-number="10.1.5" class="anchored" data-anchor-id="resources-custom">
<span class="header-section-number">10.1.5</span> Resources</h3>
<p>There are so many more options for data visualisation in R than we have time to cover here. The following resources will get you started on your journey to informative, intuitive visualisations.</p>
<ul>
<li>
<a href="http://www.r-graph-gallery.com/">The R Graph Gallery</a> (this is really useful)</li>
<li>
<a href="https://socviz.co/lookatdata.html">Look at Data</a> from <a href="http://socviz.co/">Data Vizualization for Social Science</a>
</li>
<li>
<a href="http://www.cookbook-r.com/Graphs">Graphs</a> in <em>Cookbook for R</em>
</li>
<li><a href="http://r-statistics.co/Top50-Ggplot2-Visualizations-MasterList-R-Code.html">Top 50 ggplot2 Visualizations</a></li>
<li>
<a href="http://www.cookbook-r.com/Graphs/">R Graphics Cookbook</a> by Winston Chang</li>
<li><a href="https://exts.ggplot2.tidyverse.org/">ggplot extensions</a></li>
<li>
<a href="https://plot.ly/ggplot2/">plotly</a> for creating interactive graphs</li>
<li><a href="https://r-spatial.org/r/2018/10/25/ggplot2-sf.html">Drawing Beautiful Maps Programmatically</a></li>
<li><a href="https://gganimate.com/">gganimate</a></li>
</ul></section></section><section id="sec-custom-reports" class="level2" data-number="10.2"><h2 data-number="10.2" class="anchored" data-anchor-id="sec-custom-reports">
<span class="header-section-number">10.2</span> Reports</h2>
<section id="setup-custom-reports" class="level3" data-number="10.2.1"><h3 data-number="10.2.1" class="anchored" data-anchor-id="setup-custom-reports">
<span class="header-section-number">10.2.1</span> Set-up</h3>
<ol type="1">
<li>Close the file <code>10-viz.qmd</code>
</li>
<li>Create a new quarto file called <code>11-reports.qmd</code>
</li>
<li>Update the YAML header</li>
<li>Replace the setup chunk with the one below:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb70-1"><a href="#cb70-1"></a><span class="in">```{r}</span></span>
<span id="cb70-2"><a href="#cb70-2"></a><span class="in">#‎| label: setup</span></span>
<span id="cb70-3"><a href="#cb70-3"></a><span class="in">#‎| include: false</span></span>
<span id="cb70-4"><a href="#cb70-4"></a></span>
<span id="cb70-5"><a href="#cb70-5"></a><span class="in"># packages needed for this chapter section</span></span>
<span id="cb70-6"><a href="#cb70-6"></a><span class="in">library(tidyverse)     # data wrangling functions</span></span>
<span id="cb70-7"><a href="#cb70-7"></a><span class="in">library(bookdown)      # for chaptered reports</span></span>
<span id="cb70-8"><a href="#cb70-8"></a><span class="in">library(flexdashboard) # for dashboards</span></span>
<span id="cb70-9"><a href="#cb70-9"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in library(flexdashboard): there is no package called 'flexdashboard'</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb72-1"><a href="#cb72-1"></a><span class="in">```{r}</span></span>
<span id="cb72-2"><a href="#cb72-2"></a><span class="in">library(DT)            # for interactive tables</span></span>
<span id="cb72-3"><a href="#cb72-3"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="interactive-tables" class="level3" data-number="10.2.2"><h3 data-number="10.2.2" class="anchored" data-anchor-id="interactive-tables">
<span class="header-section-number">10.2.2</span> Interactive tables</h3>
<p>One way to make your reports more exciting is to use interactive tables. The <code><a href="https://rdrr.io/pkg/DT/man/datatable.html">DT::datatable()</a></code> function displays a table with some extra interactive elements to allow readers to search and reorder the data, as well as controlling the number of rows shown at once. This can be especially helpful. This only works with HTML output types. The <a href="https://rstudio.github.io/DT/">DT website</a> has extensive tutorials, but we’ll cover the basics here.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1"></a><span class="fu">library</span>(DT)</span>
<span id="cb73-2"><a href="#cb73-2"></a></span>
<span id="cb73-3"><a href="#cb73-3"></a>scotpop <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/scottish_population.csv"</span>, </span>
<span id="cb73-4"><a href="#cb73-4"></a>                    <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span>
<span id="cb73-5"><a href="#cb73-5"></a></span>
<span id="cb73-6"><a href="#cb73-6"></a><span class="fu">datatable</span>(<span class="at">data =</span> scotpop)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-8a6b8630c45872e60ed0" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-8a6b8630c45872e60ed0">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32"],["Aberdeen","Aberdeenshire","Angus","Argyll and Bute","Edinburgh","Clackmannanshire","Dumfries and Galloway","Dundee","East Ayrshire","East Dunbartonshire","East Lothian","East Renfrewshire","Eilean Siar","Falkirk","Fife","Glasgow","Highland","Inverclyde","Midlothian","Moray","North Ayrshire","North Lanarkshire","Orkney","Perthshire and Kinross","Renfrewshire","Scottish Borders","Shetland Islands","South Ayrshire","South Lanarkshire","Stirling","West Dunbartonshire","West Lothian"],[217120,245780,110570,89200,486120,50630,148190,144290,120240,104580,97500,89540,26190,153280,365020,592820,221630,79770,81140,87720,135180,326360,20110,147780,170250,112870,22400,111440,311880,89850,90570,172080]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>name<\/th>\n      <th>population<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":2},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"name","targets":1},{"name":"population","targets":2}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>You can customise the display, such as changing column names, adding a caption, moving the location of the filter boxes, removing row names, applying <a href="https://datatables.net/manual/styling/classes">classes</a> to change table appearance, and applying <a href="https://datatables.net/reference/option/">advanced options</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1"></a><span class="co"># https://datatables.net/reference/option/</span></span>
<span id="cb74-2"><a href="#cb74-2"></a>my_options <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb74-3"><a href="#cb74-3"></a>  <span class="at">pageLength =</span> <span class="dv">5</span>, <span class="co"># how many rows are displayed</span></span>
<span id="cb74-4"><a href="#cb74-4"></a>  <span class="at">lengthChange =</span> <span class="cn">FALSE</span>, <span class="co"># whether pageLength can change</span></span>
<span id="cb74-5"><a href="#cb74-5"></a>  <span class="at">info =</span> <span class="cn">TRUE</span>, <span class="co"># text with the total number of rows</span></span>
<span id="cb74-6"><a href="#cb74-6"></a>  <span class="at">paging =</span> <span class="cn">TRUE</span>, <span class="co"># if FALSE, the whole table displays</span></span>
<span id="cb74-7"><a href="#cb74-7"></a>  <span class="at">ordering =</span> <span class="cn">FALSE</span>, <span class="co"># whether you can reorder columns</span></span>
<span id="cb74-8"><a href="#cb74-8"></a>  <span class="at">searching =</span> <span class="cn">FALSE</span> <span class="co"># whether you can search the table</span></span>
<span id="cb74-9"><a href="#cb74-9"></a>)</span>
<span id="cb74-10"><a href="#cb74-10"></a></span>
<span id="cb74-11"><a href="#cb74-11"></a><span class="fu">datatable</span>(</span>
<span id="cb74-12"><a href="#cb74-12"></a>  <span class="at">data =</span> scotpop,</span>
<span id="cb74-13"><a href="#cb74-13"></a>  <span class="at">colnames =</span> <span class="fu">c</span>(<span class="st">"County"</span>, <span class="st">"Population"</span>),</span>
<span id="cb74-14"><a href="#cb74-14"></a>  <span class="at">caption =</span> <span class="st">"The population of Scottish counties."</span>,</span>
<span id="cb74-15"><a href="#cb74-15"></a>  <span class="at">filter =</span> <span class="st">"none"</span>, <span class="co"># "none", "bottom" or "top"</span></span>
<span id="cb74-16"><a href="#cb74-16"></a>  <span class="at">rownames =</span> <span class="cn">FALSE</span>, <span class="co"># removes the number at the left</span></span>
<span id="cb74-17"><a href="#cb74-17"></a>  <span class="at">class =</span> <span class="st">"cell-border hover stripe"</span>, <span class="co"># default is "display"</span></span>
<span id="cb74-18"><a href="#cb74-18"></a>  <span class="at">options =</span> my_options</span>
<span id="cb74-19"><a href="#cb74-19"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-f09c826ffb7a91897d25" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-f09c826ffb7a91897d25">{"x":{"filter":"none","vertical":false,"caption":"<caption>The population of Scottish counties.<\/caption>","data":[["Aberdeen","Aberdeenshire","Angus","Argyll and Bute","Edinburgh","Clackmannanshire","Dumfries and Galloway","Dundee","East Ayrshire","East Dunbartonshire","East Lothian","East Renfrewshire","Eilean Siar","Falkirk","Fife","Glasgow","Highland","Inverclyde","Midlothian","Moray","North Ayrshire","North Lanarkshire","Orkney","Perthshire and Kinross","Renfrewshire","Scottish Borders","Shetland Islands","South Ayrshire","South Lanarkshire","Stirling","West Dunbartonshire","West Lothian"],[217120,245780,110570,89200,486120,50630,148190,144290,120240,104580,97500,89540,26190,153280,365020,592820,221630,79770,81140,87720,135180,326360,20110,147780,170250,112870,22400,111440,311880,89850,90570,172080]],"container":"<table class=\"cell-border hover stripe\">\n  <thead>\n    <tr>\n      <th>County<\/th>\n      <th>Population<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"lengthChange":false,"info":true,"paging":true,"ordering":false,"searching":false,"columnDefs":[{"className":"dt-right","targets":1},{"name":"name","targets":0},{"name":"population","targets":1}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="try">
<p>Create an interactive table like the one below from the <code>diamonds</code> dataset of diamonds where the <code>table</code> value is greater than 65 (the whole table is <em>much</em> too large to display with an interactive table). Show 20 items by default and remove the search box, but leave in the filter and other default options.</p>
<div class="cell">
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-7e94de14ee79e363d087" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-7e94de14ee79e363d087">{"x":{"filter":"none","vertical":false,"caption":"<caption>All diamonds with table &gt; 65.<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181"],[0.86,0.84,0.7,0.76,0.57,0.74,0.91,0.98,0.75,0.72,0.9,0.75,0.99,0.98,1.06,0.85,0.73,1.2,0.91,1,0.95,0.9,0.9,0.99,0.9,1.01,0.98,0.96,1,1.01,1.01,1.17,1.18,0.9,1,1.01,0.9,1,0.9399999999999999,0.97,0.31,0.91,1.05,1.45,1,0.51,1.07,0.9,0.91,1.18,1.07,1.45,1.13,1.17,0.3,1,1.01,0.93,1.01,1,1.65,1.14,1.5,1.16,1.42,1.24,2.01,1.44,1.57,1.5,1.51,1.52,1.53,1.76,1.55,1.51,1.52,1,1.51,1.5,1.51,2,2.1,1.91,2,1.32,2.29,1.98,1.51,2.01,2.01,2.29,2.01,2.48,2.01,0.23,2.1,0.23,0.3,0.45,0.36,0.5,0.5,0.23,0.46,0.3,0.4,0.43,0.46,0.5,0.54,0.5,0.7,0.5,0.5,0.49,0.5600000000000001,0.5,0.51,0.89,0.5,0.52,0.64,0.52,0.67,0.68,0.62,0.67,0.7,0.53,0.5,0.5600000000000001,0.57,0.75,0.71,0.71,0.7,0.75,0.73,0.96,0.7,0.5,0.75,0.77,0.74,0.7,0.7,0.7,0.7,0.77,0.6899999999999999,0.7,0.9,0.6,0.71,0.7,0.6899999999999999,0.77,0.8100000000000001,0.71,0.76,0.73,0.62,0.7,0.79,0.71,0.7,1.05,0.71,0.6,0.82,0.76,0.97,0.88,0.5,0.5,0.89,0.72,0.71,0.78,0.71],["Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Good","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Good","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Good","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Good","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Good","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Very Good","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair","Fair"],["E","G","G","G","E","F","H","E","F","F","I","E","J","F","J","G","F","I","D","G","J","E","I","I","I","F","F","E","D","G","G","I","D","D","F","E","F","F","F","F","E","H","I","F","H","F","E","F","E","I","F","J","I","H","F","G","H","D","D","G","J","G","G","F","G","D","F","H","H","E","F","H","I","J","F","G","G","D","E","E","H","I","G","I","F","F","J","H","G","F","H","J","E","I","D","D","F","G","G","F","F","F","E","F","G","E","G","H","G","E","F","H","H","F","E","D","H","G","F","H","F","I","I","F","I","G","F","F","E","E","G","F","G","J","H","I","I","J","I","F","F","G","J","J","J","H","G","G","E","J","G","H","E","G","F","I","G","I","F","F","H","I","E","G","G","D","H","I","F","F","F","D","J","I","E","E","G","H","G","H","F"],["SI2","SI1","VVS1","VS1","VVS1","VS2","SI2","SI2","VS1","VS1","VS2","VS2","SI1","SI2","SI2","VS1","VS1","I1","SI2","SI2","SI1","SI2","VVS2","SI1","VS2","SI2","SI1","SI2","SI2","SI2","SI2","SI2","SI2","VS2","SI2","SI2","VS2","SI2","SI1","SI1","SI1","VVS1","VS1","I1","VS1","VVS2","SI2","VS2","VS2","VS2","SI1","SI2","VS2","SI2","VS1","VS1","VS1","VS2","VS2","VS1","SI1","VS1","SI2","VS1","VS2","SI1","I1","VS1","VS1","SI2","SI2","VS2","VS2","VS1","SI1","VS2","VS2","VVS1","SI1","SI1","VS1","VS1","SI2","VS1","SI2","VVS1","SI1","VS1","VS1","SI1","SI2","VS2","SI2","SI2","SI2","VVS1","SI2","VVS2","VVS1","SI1","VS1","I1","SI2","VVS1","SI1","VVS2","SI1","SI1","VS1","SI2","SI1","VS2","I1","SI2","SI1","VS2","VS2","VS1","VS2","I1","VS1","VVS2","VS2","SI1","VS2","SI1","SI1","SI1","SI2","VS1","VVS2","VS2","VS2","SI1","VS2","VS2","SI1","VS1","SI2","I1","SI2","VVS2","VS2","SI1","VS1","SI1","SI1","SI2","SI1","VS1","VS1","VS1","I1","VVS2","SI1","VS1","VS1","VVS2","SI2","SI2","SI1","VS1","VS1","SI1","SI1","VS2","VS1","I1","SI1","VVS2","SI2","SI2","SI2","VS2","VS2","VS2","SI2","VVS2","VS2","VS2","VS1"],[55.1,55.1,58.8,59,58.7,61.1,61.3,53.3,55.8,56.9,64.09999999999999,56,58,61.6,61,57.7,58.6,62.2,62.5,64.59999999999999,58,57.5,60.9,60.7,58.5,60.1,61.8,57.7,65.59999999999999,58.7,59.8,59.2,57,57.5,59.3,56.8,58.9,59,56.8,56.4,56.9,56.5,58.9,64.8,57.4,60.7,62.2,59.5,61.8,62,60.6,58.6,55.9,60,61.7,63.1,61.4,56.3,59.1,58.7,61.6,57.5,68.5,57.8,59.6,55.6,58.7,58.1,67.3,59.9,61.8,62.1,57.7,56.9,59.7,58.1,55.2,56.7,58.4,58.2,58,58.5,61.4,59.5,59.8,58,56.8,58.3,60.8,58.6,61.2,57,62.1,56.7,59.4,60.3,59.5,61.4,58.6,57.9,55.3,57.5,58,60.3,63.4,51,59.9,62.7,58,59.8,61.4,62.4,62.1,61.1,61.7,57.5,52.7,60.3,61,58.8,62.9,60.4,55.3,65.5,57.2,58,55.1,56,58.7,62.3,62.9,57,58.2,55,62.1,61.6,62,61.9,61.3,62.9,58.2,60.6,59.1,60.2,58.8,61,61.6,61.5,57.2,61.2,57.8,62,59.9,57.9,57,60.2,61.2,59.2,68.8,60.1,61.9,55.9,58.8,61.7,65.3,55.6,59.6,61.8,59.8,60.1,56.7,55.5,60.8,57.4,79,79,58.9,56.5,57,54.7,57.3],[2757,2782,2797,2800,2805,2805,2825,2855,2859,2879,2921,2940,2949,2958,2992,2998,3002,3011,3079,3142,3154,3187,3288,3337,3353,3597,3622,3674,3767,3816,3816,3833,3899,3931,3975,3991,3992,4036,4053,4063,579,4115,4281,4320,4368,4368,4496,4536,4550,4553,4554,4570,4695,4717,593,4892,5062,5078,5797,5853,5914,6381,6552,7094,7214,7291,7294,7338,8133,8190,8287,8674,8996,9314,10217,10553,10623,10752,11102,11128,11263,11322,11946,12244,12610,12648,12811,12923,12948,13387,13587,13701,14948,15030,15627,425,16506,369,790,794,810,827,851,472,911,945,960,984,1035,1114,1114,1122,1138,1156,1238,1249,1293,1327,1334,1334,1348,1401,1411,1427,1436,1633,1641,1642,1723,1778,1791,1814,1816,1827,1832,1840,1848,1869,1892,1917,1920,1939,1944,1956,1982,1995,1995,1999,2000,2005,2070,2100,2138,2167,2198,2234,2235,2292,2301,2327,2328,2330,2344,2352,2362,2368,2395,2396,2458,2484,2508,2518,2538,2550,2579,2579,2579,2608,2623,2691,2707]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>carat<\/th>\n      <th>cut<\/th>\n      <th>color<\/th>\n      <th>clarity<\/th>\n      <th>depth<\/th>\n      <th>price<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":20,"searching":false,"columnDefs":[{"className":"dt-right","targets":[1,5,6]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"carat","targets":1},{"name":"cut","targets":2},{"name":"color","targets":3},{"name":"clarity","targets":4},{"name":"depth","targets":5},{"name":"price","targets":6}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[10,20,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell" data-webex.hide="true">
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1"></a>my_options <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb75-2"><a href="#cb75-2"></a>  <span class="at">pageLength =</span> <span class="dv">20</span>, <span class="co"># how many rows are displayed</span></span>
<span id="cb75-3"><a href="#cb75-3"></a>  <span class="at">searching =</span> <span class="cn">FALSE</span> <span class="co"># whether you can search the table</span></span>
<span id="cb75-4"><a href="#cb75-4"></a>)</span>
<span id="cb75-5"><a href="#cb75-5"></a></span>
<span id="cb75-6"><a href="#cb75-6"></a>diamonds <span class="sc">|&gt;</span> </span>
<span id="cb75-7"><a href="#cb75-7"></a>  <span class="fu">filter</span>(table <span class="sc">&gt;</span> <span class="dv">65</span>) <span class="sc">|&gt;</span></span>
<span id="cb75-8"><a href="#cb75-8"></a>  <span class="fu">select</span>(<span class="sc">-</span>table, <span class="sc">-</span>(x<span class="sc">:</span>z)) <span class="sc">|&gt;</span></span>
<span id="cb75-9"><a href="#cb75-9"></a>  DT<span class="sc">::</span><span class="fu">datatable</span>(</span>
<span id="cb75-10"><a href="#cb75-10"></a>    <span class="at">caption =</span> <span class="st">"All diamonds with table &gt; 65."</span>,</span>
<span id="cb75-11"><a href="#cb75-11"></a>    <span class="at">options =</span> my_options</span>
<span id="cb75-12"><a href="#cb75-12"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section><section id="other-formats" class="level3" data-number="10.2.3"><h3 data-number="10.2.3" class="anchored" data-anchor-id="other-formats">
<span class="header-section-number">10.2.3</span> Other formats</h3>
<p>You can create more than just reports with R Markdown. You can also create presentations, interactive dashboards, books, websites, and web applications.</p>
<section id="presentations" class="level4" data-number="10.2.3.1"><h4 data-number="10.2.3.1" class="anchored" data-anchor-id="presentations">
<span class="header-section-number">10.2.3.1</span> Presentations</h4>
<p>You can choose a presentation template when you create a new R Markdown document. We’ll use ioslides for this example, but the other formats work similarly.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="images/present/new-ioslides.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Ioslides RMarkdown template.</figcaption></figure>
</div>
</div>
</div>
<p>The main differences between this and the Rmd files you’ve been working with until now are that the <code>output</code> type in the <a href="https://psyteachr.github.io/glossary/y#yaml" target="_blank" class="glossary" title="A structured format for information">YAML</a> header is <code>ioslides_presentation</code> instead of <code>html_document</code> and this format requires a specific title structure. Each slide starts with a level-2 header.</p>
<p>The template provides you with examples of text, bullet point, code, and plot slides. You can knit this template to create an <a href="https://psyteachr.github.io/glossary/h#html" target="_blank" class="glossary" title="Hyper-Text Markup Language: A system for semantically tagging structure and information on web pages.">HTML</a> document with your presentation. It often looks odd in the RStudio built-in browser, so click the button to open it in a web browser. You can use the space bar or arrow keys to advance slides.</p>
<p>The code below shows how to load some packages and display text, a table, and a plot. You can see the <a href="demos/ioslides.html">HTML output here</a>.</p>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb76"><pre class="sourceCode numberSource md number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb76-1"><a href="#cb76-1"></a><span class="co">---</span></span>
<span id="cb76-2"><a href="#cb76-2"></a><span class="an">title:</span><span class="co"> "Presentation Demo"</span></span>
<span id="cb76-3"><a href="#cb76-3"></a><span class="an">author:</span><span class="co"> "Lisa DeBruine"</span></span>
<span id="cb76-4"><a href="#cb76-4"></a><span class="an">output:</span><span class="co"> ioslides_presentation</span></span>
<span id="cb76-5"><a href="#cb76-5"></a><span class="co">---</span></span>
<span id="cb76-6"><a href="#cb76-6"></a></span>
<span id="cb76-7"><a href="#cb76-7"></a><span class="in">```{r setup, include=FALSE}</span></span>
<span id="cb76-8"><a href="#cb76-8"></a><span class="in">knitr::opts_chunk$set(echo = FALSE)</span></span>
<span id="cb76-9"><a href="#cb76-9"></a><span class="in">library(tidyverse)</span></span>
<span id="cb76-10"><a href="#cb76-10"></a><span class="in">library(kableExtra)</span></span>
<span id="cb76-11"><a href="#cb76-11"></a><span class="in">```</span></span>
<span id="cb76-12"><a href="#cb76-12"></a></span>
<span id="cb76-13"><a href="#cb76-13"></a><span class="fu">## Slide with Markdown</span></span>
<span id="cb76-14"><a href="#cb76-14"></a></span>
<span id="cb76-15"><a href="#cb76-15"></a>The following slides will present some data from the <span class="in">`diamonds`</span> dataset from **ggplot2**.</span>
<span id="cb76-16"><a href="#cb76-16"></a></span>
<span id="cb76-17"><a href="#cb76-17"></a>Diamond price depends on many features, such as:</span>
<span id="cb76-18"><a href="#cb76-18"></a></span>
<span id="cb76-19"><a href="#cb76-19"></a><span class="ss">- </span>cut</span>
<span id="cb76-20"><a href="#cb76-20"></a><span class="ss">- </span>colour</span>
<span id="cb76-21"><a href="#cb76-21"></a><span class="ss">- </span>clarity</span>
<span id="cb76-22"><a href="#cb76-22"></a><span class="ss">- </span>carats</span>
<span id="cb76-23"><a href="#cb76-23"></a></span>
<span id="cb76-24"><a href="#cb76-24"></a><span class="fu">## Slide with a Table</span></span>
<span id="cb76-25"><a href="#cb76-25"></a></span>
<span id="cb76-26"><a href="#cb76-26"></a><span class="in">```{r}</span></span>
<span id="cb76-27"><a href="#cb76-27"></a><span class="in">diamonds %&gt;%</span></span>
<span id="cb76-28"><a href="#cb76-28"></a><span class="in">  group_by(cut, color) %&gt;%</span></span>
<span id="cb76-29"><a href="#cb76-29"></a><span class="in">  summarise(avg_price = mean(price),</span></span>
<span id="cb76-30"><a href="#cb76-30"></a><span class="in">            .groups = "drop") %&gt;%</span></span>
<span id="cb76-31"><a href="#cb76-31"></a><span class="in">  pivot_wider(names_from = cut, values_from = avg_price) %&gt;%</span></span>
<span id="cb76-32"><a href="#cb76-32"></a><span class="in">  kable(digits = 0, caption = "Mean diamond price by cut and colour.") %&gt;%</span></span>
<span id="cb76-33"><a href="#cb76-33"></a><span class="in">  kable_material()</span></span>
<span id="cb76-34"><a href="#cb76-34"></a><span class="in">```</span></span>
<span id="cb76-35"><a href="#cb76-35"></a></span>
<span id="cb76-36"><a href="#cb76-36"></a><span class="fu">## Slide with a Plot</span></span>
<span id="cb76-37"><a href="#cb76-37"></a></span>
<span id="cb76-38"><a href="#cb76-38"></a><span class="in">```{r pressure}</span></span>
<span id="cb76-39"><a href="#cb76-39"></a><span class="in">ggplot(diamonds, aes(x = cut, y = price, color = color)) +</span></span>
<span id="cb76-40"><a href="#cb76-40"></a><span class="in">  stat_summary(fun = mean, geom = "point") +</span></span>
<span id="cb76-41"><a href="#cb76-41"></a><span class="in">  stat_summary(aes(x = as.integer(cut)), </span></span>
<span id="cb76-42"><a href="#cb76-42"></a><span class="in">               fun = mean, geom = "line") +</span></span>
<span id="cb76-43"><a href="#cb76-43"></a><span class="in">  scale_x_discrete(position = "top") +</span></span>
<span id="cb76-44"><a href="#cb76-44"></a><span class="in">  scale_color_viridis_d(guide = guide_legend(reverse = TRUE)) +</span></span>
<span id="cb76-45"><a href="#cb76-45"></a><span class="in">  theme_minimal() </span></span>
<span id="cb76-46"><a href="#cb76-46"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="dashboards" class="level4" data-number="10.2.3.2"><h4 data-number="10.2.3.2" class="anchored" data-anchor-id="dashboards">
<span class="header-section-number">10.2.3.2</span> Dashboards</h4>
<p>Dashboards are a way to display text, tables, and plots with dynamic formatting. After you install <code class="package">flexdashboard</code>, you can choose a flexdashboard template when you create a new R Markdown document.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="images/present/flexdashboard-template.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Flexdashboard RMarkdown template.</figcaption></figure>
</div>
</div>
</div>
<p>The code below shows how to load some packages, display two tables in a tabset, and display two plots in a column. You can see the <a href="demos/flexdashboard.html">HTML output here</a>.</p>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb77"><pre class="sourceCode numberSource md number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb77-1"><a href="#cb77-1"></a><span class="co">---</span></span>
<span id="cb77-2"><a href="#cb77-2"></a><span class="an">title:</span><span class="co"> "Flexdashboard Demo"</span></span>
<span id="cb77-3"><a href="#cb77-3"></a><span class="an">output:</span><span class="co"> </span></span>
<span id="cb77-4"><a href="#cb77-4"></a><span class="co">  flexdashboard::flex_dashboard:</span></span>
<span id="cb77-5"><a href="#cb77-5"></a><span class="co">    social: [ "twitter", "facebook", "linkedin", "pinterest" ]</span></span>
<span id="cb77-6"><a href="#cb77-6"></a><span class="co">    source_code: embed</span></span>
<span id="cb77-7"><a href="#cb77-7"></a><span class="co">    orientation: columns</span></span>
<span id="cb77-8"><a href="#cb77-8"></a><span class="co">    vertical_layout: fill</span></span>
<span id="cb77-9"><a href="#cb77-9"></a><span class="co">---</span></span>
<span id="cb77-10"><a href="#cb77-10"></a></span>
<span id="cb77-11"><a href="#cb77-11"></a><span class="in">```{r setup, include=FALSE}</span></span>
<span id="cb77-12"><a href="#cb77-12"></a><span class="in">library(flexdashboard)</span></span>
<span id="cb77-13"><a href="#cb77-13"></a><span class="in">library(tidyverse)</span></span>
<span id="cb77-14"><a href="#cb77-14"></a><span class="in">library(kableExtra)</span></span>
<span id="cb77-15"><a href="#cb77-15"></a><span class="in">library(DT) # for interactive tables</span></span>
<span id="cb77-16"><a href="#cb77-16"></a><span class="in">theme_set(theme_minimal())</span></span>
<span id="cb77-17"><a href="#cb77-17"></a><span class="in">```</span></span>
<span id="cb77-18"><a href="#cb77-18"></a></span>
<span id="cb77-19"><a href="#cb77-19"></a>Column {data-width=350, .tabset}</span>
<span id="cb77-20"><a href="#cb77-20"></a>--------------------------------</span>
<span id="cb77-21"><a href="#cb77-21"></a></span>
<span id="cb77-22"><a href="#cb77-22"></a><span class="fu">### By Cut</span></span>
<span id="cb77-23"><a href="#cb77-23"></a></span>
<span id="cb77-24"><a href="#cb77-24"></a>This table uses <span class="in">`kableExtra`</span> to render the table with a specific theme.</span>
<span id="cb77-25"><a href="#cb77-25"></a></span>
<span id="cb77-26"><a href="#cb77-26"></a><span class="in">```{r}</span></span>
<span id="cb77-27"><a href="#cb77-27"></a><span class="in">diamonds %&gt;%</span></span>
<span id="cb77-28"><a href="#cb77-28"></a><span class="in">  group_by(cut) %&gt;%</span></span>
<span id="cb77-29"><a href="#cb77-29"></a><span class="in">  summarise(avg = mean(price),</span></span>
<span id="cb77-30"><a href="#cb77-30"></a><span class="in">            .groups = "drop") %&gt;%</span></span>
<span id="cb77-31"><a href="#cb77-31"></a><span class="in">  kable(digits = 0, </span></span>
<span id="cb77-32"><a href="#cb77-32"></a><span class="in">        col.names = c("Cut", "Average Price"),</span></span>
<span id="cb77-33"><a href="#cb77-33"></a><span class="in">        caption = "Mean diamond price by cut.") %&gt;%</span></span>
<span id="cb77-34"><a href="#cb77-34"></a><span class="in">  kable_classic()</span></span>
<span id="cb77-35"><a href="#cb77-35"></a><span class="in">```</span></span>
<span id="cb77-36"><a href="#cb77-36"></a></span>
<span id="cb77-37"><a href="#cb77-37"></a><span class="fu">### By Colour</span></span>
<span id="cb77-38"><a href="#cb77-38"></a></span>
<span id="cb77-39"><a href="#cb77-39"></a>This table uses <span class="in">`DT::datatable()`</span> to render the table with a searchable interface.</span>
<span id="cb77-40"><a href="#cb77-40"></a></span>
<span id="cb77-41"><a href="#cb77-41"></a><span class="in">```{r}</span></span>
<span id="cb77-42"><a href="#cb77-42"></a><span class="in">diamonds %&gt;%</span></span>
<span id="cb77-43"><a href="#cb77-43"></a><span class="in">  group_by(color) %&gt;%</span></span>
<span id="cb77-44"><a href="#cb77-44"></a><span class="in">  summarise(avg = mean(price),</span></span>
<span id="cb77-45"><a href="#cb77-45"></a><span class="in">            .groups = "drop") %&gt;%</span></span>
<span id="cb77-46"><a href="#cb77-46"></a><span class="in">  DT::datatable(colnames = c("Colour", "Average Price"), </span></span>
<span id="cb77-47"><a href="#cb77-47"></a><span class="in">                caption = "Mean diamond price by colour",</span></span>
<span id="cb77-48"><a href="#cb77-48"></a><span class="in">                options = list(pageLength = 5),</span></span>
<span id="cb77-49"><a href="#cb77-49"></a><span class="in">                rownames = FALSE) %&gt;%</span></span>
<span id="cb77-50"><a href="#cb77-50"></a><span class="in">  DT::formatRound(columns=2, digits=0)</span></span>
<span id="cb77-51"><a href="#cb77-51"></a><span class="in">```</span></span>
<span id="cb77-52"><a href="#cb77-52"></a></span>
<span id="cb77-53"><a href="#cb77-53"></a>Column {data-width=350}</span>
<span id="cb77-54"><a href="#cb77-54"></a>-----------------------</span>
<span id="cb77-55"><a href="#cb77-55"></a></span>
<span id="cb77-56"><a href="#cb77-56"></a><span class="fu">### By Clarity</span></span>
<span id="cb77-57"><a href="#cb77-57"></a></span>
<span id="cb77-58"><a href="#cb77-58"></a><span class="in">```{r by-clarity, fig.cap = "Diamond price by clarity"}</span></span>
<span id="cb77-59"><a href="#cb77-59"></a><span class="in">ggplot(diamonds, aes(x = clarity, y = price)) +</span></span>
<span id="cb77-60"><a href="#cb77-60"></a><span class="in">  geom_boxplot() </span></span>
<span id="cb77-61"><a href="#cb77-61"></a><span class="in">```</span></span>
<span id="cb77-62"><a href="#cb77-62"></a></span>
<span id="cb77-63"><a href="#cb77-63"></a></span>
<span id="cb77-64"><a href="#cb77-64"></a><span class="fu">### By Carats</span></span>
<span id="cb77-65"><a href="#cb77-65"></a></span>
<span id="cb77-66"><a href="#cb77-66"></a><span class="in">```{r by-carat, fig.cap = "Diamond price by carat"}</span></span>
<span id="cb77-67"><a href="#cb77-67"></a><span class="in">ggplot(diamonds, aes(x = carat, y = price)) +</span></span>
<span id="cb77-68"><a href="#cb77-68"></a><span class="in">  stat_smooth()</span></span>
<span id="cb77-69"><a href="#cb77-69"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Change the size of your web browser to see how the boxes, tables and figures change.</p>
<p>The best way to figure out how to format a dashboard is trial and error, but you can also look at some <a href="https://pkgs.rstudio.com/flexdashboard/articles/layouts.html">sample layouts</a>.</p>
</section><section id="books" class="level4" data-number="10.2.3.3"><h4 data-number="10.2.3.3" class="anchored" data-anchor-id="books">
<span class="header-section-number">10.2.3.3</span> Books</h4>
<p>You can create online books with <code class="package">bookdown</code>. In fact, the book you’re reading was created using bookdown. After you download the package, start a new project and choose “Book project using bookdown” from the list of project templates.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="images/present/bookdown.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Bookdown project template.</figcaption></figure>
</div>
</div>
</div>
<p>Each chapter is written in a separate .Rmd file and the general book settings can be changed in the <code>_bookdown.yml</code> and <code>_output.yml</code> files.</p>
</section><section id="websites" class="level4" data-number="10.2.3.4"><h4 data-number="10.2.3.4" class="anchored" data-anchor-id="websites">
<span class="header-section-number">10.2.3.4</span> Websites</h4>
<p>You can create a simple website the same way you create any R Markdown document. Choose “Simple R Markdown Website” from the project templates to get started. See Appendix&nbsp;@ref(webpages) for a step-by-step tutorial.</p>
<p>For more complex, blog-style websites, you can investigate <a href="https://bookdown.org/yihui/blogdown/"><code class="package">blogdown</code></a>. After you install this package, you will also be able to create template blogdown projects to get you started.</p>
</section><section id="shiny" class="level4" data-number="10.2.3.5"><h4 data-number="10.2.3.5" class="anchored" data-anchor-id="shiny">
<span class="header-section-number">10.2.3.5</span> Shiny</h4>
<p>To get truly interactive, you can take your R coding to the next level and learn Shiny. Shiny apps let your R code react to user input. You can do things like <a href="https://shiny.psy.gla.ac.uk/debruine/wordcloud/">make a word cloud</a>, <a href="https://shiny.psy.gla.ac.uk/debruine/seen/">search a google spreadsheet</a>, or <a href="https://shiny.psy.gla.ac.uk/debruine/question/">conduct a survey</a>.</p>
<p>This is well outside the scope of this class, but the skills you’ve learned here provide a good start. The free book <a href="https://debruine.github.io/shinyintro/">Building Web Apps with R Shiny</a> by one of the authors of this book can get you started creating shiny apps.</p>
</section></section><section id="sec-resources-report" class="level3 unnumbered"><h3 class="unnumbered anchored" data-anchor-id="sec-resources-report">Resources</h3>
<ul>
<li><a href="https://rmarkdown.rstudio.com/formats.html">RStudio Formats</a></li>
<li><a href="https://bookdown.org/yihui/rmarkdown-cookbook">R Markdown Cookbook</a></li>
<li><a href="https://rstudio.github.io/DT/">DT</a></li>
<li><a href="https://pkgs.rstudio.com/flexdashboard/">Flexdashboard</a></li>
<li><a href="https://bookdown.org/yihui/bookdown/">Bookdown</a></li>
<li><a href="https://bookdown.org/yihui/blogdown/">Blogdown</a></li>
<li><a href="https://shiny.rstudio.com/">Shiny</a></li>
<li><a href="https://debruine.github.io/shinyintro/">Building Web Apps with R Shiny</a></li>
</ul>


</section></section></main><!-- /main --><script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script><script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  if (t = document.getElementById("webex-total_correct")) {
    var correct = document.getElementsByClassName("webex-correct").length;
    var solvemes = document.getElementsByClassName("webex-solveme").length;
    var radiogroups = document.getElementsByClassName("webex-radiogroup").length;
    var selects = document.getElementsByClassName("webex-select").length;

    t.innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");

  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");

  var cl = this.classList

  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;

  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }

  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

window.onload = function() {
  console.log("webex onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;

    $(solveme[i]).after(" <span class='webex-icon'></span>");
  }

  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }

  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
    $(selects[i]).after(" <span class='webex-icon'></span>");
  }

  update_total_correct();
}

</script><script>
$( document ).ready(function() {
  function move_sidebar() {
    var w = window.innerWidth;
    if (w < 768) {
      $("#TOC").appendTo($("#quarto-sidebar .sidebar-menu-container"));
    } else {
      $("#TOC").appendTo($("#quarto-margin-sidebar"));
    }
  }
  move_sidebar();
  window.onresize = move_sidebar;
});
</script><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("^(?:http:|https:)\/\/psyteachr\.github\.io\/reprores-v5");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
          // default icon
          link.classList.add("external");
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          trigger: 'click',
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          positionFixed: true,
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./09-sim.html" class="pagination-link" aria-label="Probability &amp; Simulation">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Probability &amp; Simulation</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./assessment-1.html" class="pagination-link" aria-label="Assessment 1">
        <span class="nav-page-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Assessment 1</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>CC-BY 2025, psyTeachR</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/psyteachr/reprores-v5/edit/master/10-next.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/psyteachr/reprores-v5/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li><li><a href="https://github.com/psyteachr/reprores-v5/blob/master/10-next.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
<li class="nav-item compact">
    <a class="nav-link" href="https://github.com/psyteachr/reprores-v5">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://doi.org/10.5281/zenodo.6527194">
      <i class="bi bi-https://zenodo.org/badge/DOI/10.5281/zenodo.6527194.svg" role="img">
</i> 
    </a>
  </li>  
</ul>
</div>
  </div>
</footer>


</body></html>